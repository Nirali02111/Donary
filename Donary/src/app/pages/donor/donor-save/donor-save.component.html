<div class="create__donor edit_donors-modal" ngbAutofocus tabindex="-1">
  <div class="modal-header modal__custom_header">
    <span (click)="closePopup()" class="material-icons hidden-desktop icon-back">keyboard_arrow_left</span>
    <h4>{{ title | translate }}</h4>
    <div class="close_trans" (click)="closePopup()"><span>&times;</span></div>
  </div>

  <div class="tabs__wrap modal__custom_content create-donor-header">
    <!-- Tab start -->
    <ul class="nav nav-tabs">
      <li class="active"
        [ngStyle]="{'margin-left': isloading ? '10px' : '0px','margin-top': isloading ? '10px' : '0px'}">
        <app-skeleton-loader-component [isLoading]="isloading" [theme]="{ width: '110px', height: '30px' }"> <a
            (click)="activateTab('donorinfo')" class="li_tab active" [ngClass]="{'active': activeTab === 'donorinfo'}"
            id="donorinfo" data-toggle="tab" href="#editdonorInfo" role="tab">
            {{ "DONORINFO" | translate }}
          </a></app-skeleton-loader-component>
      </li>

      <li [ngClass]="{ disabled: !formValid }"
        [ngStyle]="{'margin-left': isloading ? '10px' : '0px','margin-top': isloading ? '10px' : '0px'}">

        <app-skeleton-loader-component [isLoading]="isloading" [theme]="{ width: '110px', height: '30px' }"> <a
            (click)="activateTab('advancedfield')" [ngClass]="{'active': activeTab === 'advancedfield'}"
            data-toggle="tab" class="li_tab" id="advancedfield" href="#advancedFields" role="tab">{{ "ADVANCEDFIELDS" |
            translate }}</a></app-skeleton-loader-component>
      </li>
      <li [ngClass]="{ disabled: !formValid }"
        [ngStyle]="{'margin-left': isloading ? '10px' : '0px','margin-top': isloading ? '10px' : '0px'}">
        <app-skeleton-loader-component [isLoading]="isloading" [theme]="{ width: '110px', height: '30px' }"> <a
            (click)="activateTab('familytree')" [ngClass]="{'active': activeTab === 'familytree'}" data-toggle="tab"
            class="li_tab" id="familytree" href="#editfamilyTree" role="tab">
            {{ "FAMILYTREE" | translate }}</a></app-skeleton-loader-component>
      </li>

      <li [ngClass]="{ disabled: !formValid }"
        [ngStyle]="{'margin-left': isloading ? '10px' : '0px','margin-top': isloading ? '10px' : '0px'}">
        <app-skeleton-loader-component [isLoading]="isloading" [theme]="{ width: '110px', height: '30px' }"> <a
            (click)="activateTab('tags')" [ngClass]="{'active': activeTab === 'tags'}" data-toggle="tab" class="li_tab"
            id="tags" href="#tagsPan" role="tab">
            {{ "TAGS" | translate }}</a></app-skeleton-loader-component>
      </li>

      <li [ngClass]="{ disabled: !formValid }"
        [ngStyle]="{'margin-left': isloading ? '10px' : '0px','margin-top': isloading ? '10px' : '0px'}">
        <app-skeleton-loader-component [isLoading]="isloading" [theme]="{ width: '110px', height: '30px' }"> <a
            (click)="activateTab('location')" [ngClass]="{'active': activeTab === 'location'}" data-toggle="tab"
            class="li_tab" id="location" href="#tab-location" role="tab">{{ "LOCATIONS" | translate
            }}</a></app-skeleton-loader-component>
      </li>
    </ul>
    <!-- Tab end -->

    <!-- Tab content start -->
    <div class="tab-content">
      <div class="tab-pane active" id="editdonorInfo" role="tabpanel" [ngClass]="{'active': activeTab === 'donorinfo'}">
        <form class="form--wrap" name="donorInfoForm" (ngSubmit)="ff.form.valid && SaveDonorInfo()" #ff="ngForm">
          <div class="donor_create">
            <div class="inside_wrap">
              <div class="form-group-block edit-donor-top-wrap search-global-donor">
                <div class="block_label">
                  <app-skeleton-loader-component [isLoading]="isloading" [theme]="{ width: '110px', height: '30px' }">
                    {{ "SEARCHGLOBALDONOR" | translate }}:</app-skeleton-loader-component>
                </div>
                <div class="block_inputs">
                  <app-skeleton-loader-component [isLoading]="isloading" [theme]="{ width: '430px', height: '30px' }">
                    <div class="form-group">
                      <div class="colm colm-12">
                        <input type="text" autofocus class="form-control" (keyup)="EnterDonor($event)"
                          [(ngModel)]="globalDonor" name="txtglobalDonor" id="globalDonorText" />

                        <button class="search_btn hover_tooltip" *ngIf="isSearchDisable" data-toggle="tooltip"
                          t-title="Need to be more then 3 characters" type="button" [disabled]="isSearchDisable"
                          (click)="SearchGlobalDonor()">
                          {{ "SEARCH" | translate }}
                        </button>
                        <button class="search_btn hover_tooltip" *ngIf="!isSearchDisable" data-toggle="tooltip"
                          type="button" (click)="SearchGlobalDonor()">
                          {{ "SEARCH" | translate }}
                        </button>
                      </div>

                      <div *ngIf="
                        commonMethodService.donorList.length == 0 &&
                        noResult &&
                        !commonMethodService.loaderSearch
                      " class="row">
                        <div class="val-error">
                          {{ "NORESULTFOUND" | translate }}
                        </div>
                      </div>
                      <div class="donor_infolist" (clickOutside)="onClickedOutside()" *ngIf="
                        commonMethodService.donorList.length != 0 &&
                        showGlobalDonor
                      ">
                        <div *ngFor="let item of commonMethodService.donorList">
                          <div class="donor_row" *ngIf="item.globalId != null"
                            (click)="SelectGlobalDonor(item.accountId)">
                            <app-donor-list-template [donorObj]="item"></app-donor-list-template>
                          </div>
                        </div>
                      </div>
                    </div>
                  </app-skeleton-loader-component>
                </div>
              </div>
              <div class="form-group-block edit-donor-top-wrap" *ngIf="!isRemoveAccountNumber">
                <div class="block_label"><app-skeleton-loader-component [isLoading]="isloading"
                    [theme]="{ width: '110px', height: '30px' }">{{ "ACCOUNT#" | translate
                    }}:</app-skeleton-loader-component></div>
                <div class="block_inputs">
                  <app-skeleton-loader-component [isLoading]="isloading" [theme]="{ width: '430px', height: '30px' }">
                    <div class="form-group">

                      <div class="colm colm-12">
                        <input type="text" [disabled]="isRemoveAccountNumber ? false : true" autofocus tabindex="1"
                          class="form-control {{ isSetBorderCls }}" [ngClass]="{
                            'is-invalid': ff.submitted && txtAccountNum.invalid
                          }" id="txtAccountNum" [(ngModel)]="accountNum" #txtAccountNum="ngModel" name="txtAccountNum"
                          (keyup)="duplicateAccNumber($event)" [ngStyle]="
                            !isRemoveAccountNumber ? { opacity: '0.5' } : null
                          " />
                        <span *ngIf="isDuplicateAccNumber" class="account-duplicate"
                          style="color: red; font-style: italic">{{ "DUPLICATEACCOUNT" | translate }}</span>
                      </div>
                    </div>
                  </app-skeleton-loader-component>
                </div>
              </div>

              <div class="form-group-block edit-donor-top-wrap row-yiddish-name">
                <div class="block_label"><app-skeleton-loader-component [isLoading]="isloading"
                    [theme]="{ width: '110px', height: '30px' }">{{ "YIDDISHNAME" | translate
                    }}:</app-skeleton-loader-component></div>
                <div class="block_inputs">
                  @if(isloading){
                  <app-skeleton-loader-component [isLoading]="isloading"
                    [theme]="{ width: '210px', height: '30px' }"></app-skeleton-loader-component>
                  <span [ngStyle]="{'margin-left':isloading?'10px':'0px'}">
                    <app-skeleton-loader-component [isLoading]="isloading"
                      [theme]="{ width: '210px', height: '30px' }"></app-skeleton-loader-component>
                  </span>
                  }@else {
                  <div class="form-group">
                    <!-- <div class="colm colm-12">
                      <input type="text" class="form-control lng_hebrew" placeholder="ערשטע נאמען" [ngClass]="[nameJewishReq ? 'error-field' : '']" (keyup)="ValidDonorKeyPress($event,'namejewish')" (keypress)="commonMethodService.HebrewOnly($event)" [ngClass]="{ 'is-invalid': ff.submitted && txtFullNameJewish.invalid }"  id="txtFullNameJewish" [(ngModel)]="fullNameJewish"   #txtFullNameJewish="ngModel" name="txtFullNameJewish" />
                    </div> -->
                    <div class="colm colm-12">
                      <input type="text" class="form-control" [ngClass]="[lastNameJewishReq ? 'error-field' : '']"
                        style="direction: RTL" (keyup)="
                            checkContains_heb($event.target.value);
                            removeErrorMsg('lastNameJewishReq')
                          " placeholder="לעצטע נאמען" (keyup)="ValidDonorKeyPress($event, 'lastnamejewish')"
                        id="txtLastNameJewish" [(ngModel)]="lastNameJewish" #txtLastNameJewish="ngModel"
                        name="txtLastNameJewish" />
                    </div>
                    <div *ngIf="lastNameJewishReq" class="row text-danger">
                      <div class="val-error">Name is required</div>
                    </div>
                  </div>
                  <div class="form-group">
                    <div class="colm colm-12">
                      <div class="colm colm-12">
                        <input type="text" class="form-control" style="direction: RTL"
                          (keyup)="checkContains_heb1($event.target.value)" placeholder="ערשטע נאמען" (keyup)="
                              ValidDonorKeyPress($event, 'namejewish');
                              removeErrorMsg('nameJewishReq')
                            " [ngClass]="[nameJewishReq ? 'error-field' : '']" [ngClass]="{
                              'is-invalid':
                                f.submitted && txtFirstNameJewish.invalid
                            }" id="txtFirstNameJewish" [(ngModel)]="firstNameJewish" #txtFirstNameJewish="ngModel"
                          name="txtFirstNameJewish" />
                      </div>
                      <div *ngIf="nameJewishReq" class="row text-danger">
                        <div class="val-error">Name is required</div>
                      </div>
                    </div>
                  </div>
                  }
                </div>
              </div>

              <div class="form-group-block edit-donor-top-wrap row-yiddish-title">
                <div class="block_label"><app-skeleton-loader-component [isLoading]="isloading"
                    [theme]="{ width: '90px', height: '30px' }">{{ "YIDDISHTITLE" | translate
                    }}:</app-skeleton-loader-component></div>
                <div class="block_inputs row-yiddish-name">
                  <app-skeleton-loader-component [isLoading]="isloading" [theme]="{ width: '90px', height: '30px' }">
                    <div class="form-group">
                      <input type="text" class="form-control lng_hebrew" style="direction: RTL" placeholder='הי"ו'
                        (keyup)="
                        ValidDonorKeyPress($event, 'suffixJewish');
                        checkContains_heb_txtSuffixJewish($event.target.value)
                      " [ngClass]="{
                        'is-invalid': f.submitted && txtSuffixJewish.invalid
                      }" id="txtSuffixJewish" [(ngModel)]="suffixJewish" #txtSuffixJewish="ngModel"
                        name="txtSuffixJewish" />
                    </div>
                  </app-skeleton-loader-component>
                  <div class="form-group">
                    <app-skeleton-loader-component [isLoading]="isloading" [theme]="{ width: '90px', height: '30px' }">
                      <input type="text" class="form-control lng_hebrew" style="direction: RTL" placeholder="מו''ה"
                        (keyup)="
                        ValidDonorKeyPress($event, 'titleJewish');
                        checkContains_heb_txtTitleJewish($event.target.value)
                      " [ngClass]="{
                        'is-invalid': f.submitted && txtTitleJewish.invalid
                      }" id="txtTitleJewish" [(ngModel)]="titleJewish" #txtTitleJewish="ngModel"
                        name="txtTitleJewish" />
                    </app-skeleton-loader-component>
                  </div>
                </div>
              </div>
              <div class="form-group-block edit-donor-top-wrap row-english-name">
                <div class="block_label"><app-skeleton-loader-component [isLoading]="isloading"
                    [theme]="{ width: '110px', height: '30px' }">{{ "ENGLISHNAME" | translate
                    }}:</app-skeleton-loader-component></div>
                <div class="block_inputs">
                  @if(isloading){
                  <app-skeleton-loader-component [isLoading]="isloading"
                    [theme]="{ width: '90px', height: '30px' }"></app-skeleton-loader-component>
                  <span [ngStyle]="{'margin-left':isloading?'10px':'0px'}">
                    <app-skeleton-loader-component [isLoading]="isloading"
                      [theme]="{ width: '90px', height: '30px' }"></app-skeleton-loader-component>
                  </span>
                  <span [ngStyle]="{'margin-left':isloading?'10px':'0px'}">
                    <app-skeleton-loader-component [isLoading]="isloading"
                      [theme]="{ width: '90px', height: '30px' }"></app-skeleton-loader-component>
                  </span>
                  }@else {

                  <div class="form-group">
                    <div class="colm colm-12">
                      <input type="text" class="form-control" placeholder="{{ 'MR' | translate }}Mr."
                        id="txtTitleEnglish" [(ngModel)]="titleEnglish" #txtTitleEnglish="ngModel"
                        name="txtTitleEnglish" />
                    </div>
                  </div>
                  <div class="form-group" [ngStyle]="{'margin-left':isloading?'10px':'0px'}">

                    <div class="colm colm-12">
                      <div class="colm colm-12">
                        <input type="text" class="form-control" placeholder="{{ 'FIRSTNAME' | translate }}"
                          [ngClass]="[nameReq ? 'error-field' : '']" (keyup)="
                             ValidDonorKeyPress($event, 'name');
                             removeErrorMsg('nameReq')
                           " [ngClass]="{
                             'is-invalid':
                               f.submitted && txtFirstNameEnglish.invalid
                           }" id="txtFirstNameEnglish" [(ngModel)]="firstNameEnglish" #txtFirstNameEnglish="ngModel"
                          name="txtFirstNameEnglish" />
                      </div>
                      <div *ngIf="nameReq" class="row text-danger">
                        <div class="val-error">Name is required</div>
                      </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <div class="colm colm-12">
                      <input type="text" class="form-control" [ngClass]="[lastNameReq ? 'error-field' : '']"
                        placeholder="{{ 'LASTNAME' | translate }}" (keyup)="
                           ValidDonorKeyPress($event, 'Lastnameenglish');
                           removeErrorMsg('lastNameReq')
                         " id="txtLastNameEnglish" [(ngModel)]="lastNameEnglish" #txtLastNameEnglish="ngModel"
                        name="txtLastNameEnglish" />
                    </div>
                    <div *ngIf="lastNameReq" class="row text-danger">
                      <div class="val-error">Name is required</div>
                    </div>
                  </div>
                  }
                </div>
              </div>
              <div class="modal-devider">
                <h4>{{ "ADDRESS" | translate }}</h4>
              </div>
              <div class="form-group-block" (clickOutside)="onClickedOutsidePrimary()">
                <section class="form-group-block-section" *ngFor="let address of donorAddresses; let i = index">
                  <div class="block_label">
                    @if(!isloading){
                    <span class="arrow_trigger" *ngIf="hideHomeAddressCell(address.addressLabel)"
                      (click)="OpenHomeAddressPopup(i)"><i class="fa fa-chevron-down"></i></span>
                    }

                    <app-skeleton-loader-component [isLoading]="isloading" [theme]="{ width: '90px', height: '30px' }">
                      <label id="lblOpenHomeAddressPopup_{{ i }}">{{
                        address.addressLabel | translate
                        }}:</label></app-skeleton-loader-component>
                    @if(!isloading){

                    <span *ngIf="address.isDefault && address.addressLabel" class="read-only-text">{{
                      "PRIMARY" | translate
                      }}</span>
                    }
                    <div class="dropdown-menu custom-radio-btn" id="isOpenHomeAddressPopup_{{ i }}" style="top: 25px">
                      <ul class="dynLableText">
                        <li *ngFor="let dyAddressLabel of this.addressLabelArray">
                          <label for="{{dyAddressLabel.addressRdioId +'_'+ i}}"
                            [ngClass]="isAddressLabelExist(dyAddressLabel.labelName)" *ngIf="dyAddressLabel.labelName">
                            <input #checkboxes type="radio" id="{{dyAddressLabel.addressRdioId +'_'+ i}}"
                              name="dyAddressLabel_rdo" [value]="dyAddressLabel.labelName" (change)="
                                              AddressDynRadioDisplayValue(
                                                $event,
                                                this.dropDownId,
                                                dyAddressLabel.labelName
                                              )
                                            " />
                            <span><i>{{fieldsShortName(dyAddressLabel.labelName) }}</i></span>
                          </label>
                          <div class="edit-btn"
                            (click)="editAddressLabelDyn($event, dyAddressLabel);dyAddressLabel.editVisable=true;"
                            *ngIf="showHideLabelList(dyAddressLabel.labelName)">
                            <i class="fa fa-pencil"></i>
                          </div>
                          <ng-container *ngIf="dyAddressLabel.editVisable">
                        <li>
                          <div class="input_editAdd">
                            <input class="type_text label-error"
                              [ngStyle]="{'border-color': (isAddressListLabelExist) ? '#ff0404' : 'null'}"
                              id="editLabelData" maxlength="15" placeholder="" type="text" name="editLabelData"
                              [(ngModel)]="selectedAddressLabel" (click)="editLabelData($event)"
                              (keyup)="removeAddressLabelError()" />
                            <div class="saveInput"
                              [ngClass]="isAddressEditLabelBtnDisable ?'edit-label-Btn-disable': ''"
                              (click)="saveNewAddressLabel($event,dyAddressLabel.addressRdioId +'_'+ i)">
                              Save
                            </div>

                          </div>
                          <span *ngIf="isAddressListLabelExist" style="color: red;text-transform: capitalize;
                                          margin-top: 3px;
                                          display: block;">Duplicate Label</span>
                        </li>
                        </ng-container>
                        </li>

                        <ng-container *ngIf="addNewLabel">
                          <li>
                            <span class="input_editAdd"><input class="type_text label-error"
                                [ngStyle]="{'border-color': (isAddressListLabelExist) ? '#ff0404' : 'null'}"
                                id="editLabelData" maxlength="15" placeholder="" type="text" name="editLabelData"
                                [(ngModel)]="selectedAddressLabel" (click)="editLabelData($event)"
                                (keyup)="removeAddressLabelError()" />
                              <div class="saveInput" (click)="saveNewAddressLabel($event)">
                                Save
                              </div>
                            </span>
                            <span *ngIf="isAddressListLabelExist" style="color: red;text-transform: capitalize;
                                          margin-top: 3px;
                                          display: block;">Duplicate Label</span>
                          </li>
                        </ng-container>
                        <li class="addLabelBtn">
                          <div (click)="addNewAddressLabel($event)">
                            <i class="fa fa-plus"></i> Add label
                          </div>
                        </li>
                        <li class="custom-checkbox-btn">
                          <label for="primaryA_{{ i }}">
                            <input type="checkbox" id="primaryA_{{ i }}" value="" [checked]="address.isDefault" class=""
                              (click)="primryAddress($event, i)" />
                            <span><i>{{ "MAKEPRIMARY" | translate }}</i></span>
                          </label>
                        </li>
                      </ul>
               
                    </div>
                  </div>

                  <div class="block_inputs with_add_btn">

                    <div class="form-group" id="idtxtcareOf_{{ i }}" *ngIf="
                                      address.addressLabel === 'WORK' ||
                                      address.addressLabel === 'Work' ||
                                      address.addressLabel === 'work' ||
                                      address.addressLabel === 'Business' ||
                                      address.addressLabel === 'BUSINESS' ||
                                      address.addressLabel === 'business'
                                    ">
                      <div class="colm colm-12">
                        <app-skeleton-loader-component [isLoading]="isloading"
                          [theme]="{ width: '450px', height: '30px' }">
                          <input type="text" class="form-control" placeholder="{{ 'ADDRESSNAMETITLE' | translate }}"
                            name="txtcareOf_{{ i }}" [(ngModel)]="address.careOf" /></app-skeleton-loader-component>
                      </div>
                    </div>
                    <div class="form-group primary_address">
                    
                      <div class="colm colm-6 br-0">
                        <app-skeleton-loader-component [isLoading]="isloading"
                          [theme]="{ width: '170px', height: '30px' }">
                          <input type="text" class="form-control" placeholder="{{ 'STREETADDRESS' | translate }}"
                            [ngClass]="[address.invalid || address.isLabelErrorMessage ? 'error-field' : '']"
                            name="txtStreet_{{ i }}" [(ngModel)]="address.streetAddress" appAddressAutocomplete
                            (onAddressChange)="onAddressChange($event, i)" />
                        </app-skeleton-loader-component>
                        <div *ngIf="address.invalid" class="row text-danger">
                          <div class="val-error">
                            {{"ADDRESS" | translate }} {{ "INVALID" | translate }}
                          </div>
                        </div>
                        <div class="row text-danger" *ngIf="address.isLabelErrorMessage">
                          <div class="val-error">
                            Label is required
                          </div>
                        </div>
                      </div>
                      <div class="colm colm-3" [ngStyle]="{'margin-left':isloading?'10px':'0px'}">
                        <app-skeleton-loader-component [isLoading]="isloading"
                          [theme]="{ width: '280px', height: '30px' }">
                          <input type="text" class="form-control" placeholder="{{ 'APT' | translate }}"
                            name="txtUnit_{{ i }}" [(ngModel)]="address.unit" /></app-skeleton-loader-component>
                      </div>
                    </div>
                    <div class="form-group primary_address">
                      <div class="colm colm-4 br-0">
                        <app-skeleton-loader-component [isLoading]="isloading"
                          [theme]="{ width: '220px', height: '30px' }">
                          <input type="text" class="form-control" placeholder="{{ 'CITY' | translate }}"
                            name="txtCity_{{ i }}" [(ngModel)]="address.city" /></app-skeleton-loader-component>
                      </div>
                      <div class="colm colm-2 br-0">
                       
                        <app-skeleton-loader-component [isLoading]="isloading"
                          [theme]="{ width: '110px', height: '30px' }">
                          <ng-select bindLabel="id" bindValue="id" name="txtState_{{ i }}" [(ngModel)]="address.state"
                            [addTag]="true" [selectOnTab]="true" [closeOnSelect]="true"
                            [items]="commonMethodService.stateList">
                            <ng-template ng-option-tmp let-item="item">
                              {{ item.id }}
                            </ng-template>
                          </ng-select></app-skeleton-loader-component>
                      </div>
                      <div class="colm colm-3 zip-input" [ngStyle]="{'margin-left':isloading?'10px':'0px'}">
                        <app-skeleton-loader-component [isLoading]="isloading"
                          [theme]="{ width: '110px', height: '30px' }">
                          <input type="text" class="form-control" placeholder="{{ 'ZIP' | translate }}"
                            name="txtZip_{{ i }}" [(ngModel)]="address.zip" /></app-skeleton-loader-component>
                      </div>
                      @if(!isloading){
                      <button type="button" class="delete_btn" *ngIf="i >= 1" (click)="deleteDonorAddress(i)">
                        <i class="fa fa-trash" aria-hidden="true"></i>
                      </button>
                      }
                    </div>
                  </div>
                </section>
                @if(!isloading){
                <div class="colm colm-12 add_btn_default dynamic-add-btn">
                  <button type="button" class="btn" (click)="addDonorAddress()">
                    <i class="fa fa-plus" aria-hidden="true"></i>
                    <span>{{ "ADD" | translate }}</span>
                  </button>
                </div>
                }
              </div>
              
              <!-- coding start -->
              <div class="modal-devider">
                <h4>{{ "PHONE" | translate }}</h4>
              </div>

              <section *ngFor="let phone of homephone; let i = index">
                <div class="form-group-block">
                  <div class="block_label">
                    @if(!isloading){

                    <span class="arrow_trigger" *ngIf="hideHomeCell(phone.phoneLabel)"
                      (click)="OpenHomePhonePopup(i)"><i class="fa fa-chevron-down"></i></span>
                    }
                    <app-skeleton-loader-component [isLoading]="isloading"
                      [theme]="{ width: '110px', height: '30px' }"><label id="lblHomePhoneOpen_{{ i }}">{{
                        phone.phoneLabel | translate
                        }}</label>:</app-skeleton-loader-component><br />
                    @if(!isloading){

                    <span *ngIf="false" class="read-only-text">
                      {{
                      "PRIMARY" | translate
                      }}</span>
                    }
                    <div class="dropdown-menu custom-radio-btn" id="idHomePhoneOpen_{{ i }}" style="top: 30px">

                      <ul class="dynLableText">
                        <li *ngFor="let dyPhoneLabel of this.phoneLabelArray">
                          <label for="{{dyPhoneLabel.phoneRdioId +'_'+ i}}"
                            [ngClass]="isLabelExist(dyPhoneLabel.labelName)">
                            <app-skeleton-loader-component [isLoading]="isloading"
                              [theme]="{ width: '90px', height: '30px' }">
                              <input type="radio" id="{{dyPhoneLabel.phoneRdioId +'_'+ i}}" name="dyPhoneLabel_rdo"
                                [value]="dyPhoneLabel.labelName" [(ngModel)]="dyPhoneLabel.labelName" (change)="
                                DynRadioDisplayValue(
                                  $event,
                                  this.dropDownId,
                                  dyPhoneLabel.labelName,
                                  dyPhoneLabel.labelID
                                )
                              " /></app-skeleton-loader-component>
                            <span><app-skeleton-loader-component [isLoading]="isloading"
                                [theme]="{ width: '90px', height: '30px' }"><i>{{fieldsShortName(dyPhoneLabel.labelName)
                                  }}</i></app-skeleton-loader-component></span>
                          </label>
                          <div class="edit-btn"
                            (click)="editLableDyn($event, dyPhoneLabel);dyPhoneLabel.editVisable=true;"
                            *ngIf="showHideLabelList(dyPhoneLabel.labelName)">
                            <i class="fa fa-pencil"></i>
                          </div>
                          <ng-container *ngIf="dyPhoneLabel.editVisable">
                        <li>
                          <div class="input_editAdd">
                            <input class="type_text label-error"
                              [ngStyle]="{'border-color': (isListLabelExist) ? '#ff0404' : 'null'}" id="editLabelData"
                              maxlength="15" placeholder="" type="text" name="editLabelData" [(ngModel)]="selectedLabel"
                              (click)="editLabelData($event)" (keyup)="removeLableError()" />
                            <div class="saveInput" [ngClass]="isEditLabelBtnDisable ?'edit-label-Btn-disable': ''"
                              (click)="saveNewPhoneLabel($event,dyPhoneLabel.phoneRdioId +'_'+ i)">
                              Save
                            </div>

                          </div>
                          <span *ngIf="isListLabelExist" style="color: red;text-transform: capitalize;
                            margin-top: 3px;
                            display: block;">Duplicate Label</span>
                        </li>
                        </ng-container>
                        </li>

                        <ng-container *ngIf="addNewLabel">
                          <li>
                            <span class="input_editAdd"><input class="type_text label-error"
                                [ngStyle]="{'border-color': (isListLabelExist) ? '#ff0404' : 'null'}" id="editLabelData"
                                maxlength="15" placeholder="" type="text" name="editLabelData"
                                [(ngModel)]="selectedLabel" (click)="editLabelData($event)"
                                (keyup)="removeLableError()" />
                              <div class="saveInput" (click)="saveNewPhoneLabel($event)">
                                Save
                              </div>
                            </span>
                            <span *ngIf="isListLabelExist" style="color: red;text-transform: capitalize;
                            margin-top: 3px;
                            display: block;">Duplicate Label</span>
                          </li>
                        </ng-container>
                        <li class="addLabelBtn">
                          <div (click)="addNewPhoneLabel($event)">
                            <i class="fa fa-plus"></i> Add label
                          </div>
                        </li>
                      </ul>


                    </div>
                  </div>

                  <div class="block_inputs">
                    <div [ngClass]="
                        i >= 2
                          ? 'form-group with_add_btn mb-0'
                          : 'form-group mb-0'
                      ">
                      <div class="colm colm-number colm-12">
                        @if(isloading){
                        <app-skeleton-loader-component [isLoading]="isloading"
                          [theme]="{ width: '420px', height: '30px' }"></app-skeleton-loader-component>
                        }@else {

                        <div class="d-flex align-items-stretch">

                          <div class="dropdown">
                            <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown"
                              aria-expanded="false"><i class={{phone.selectedFlag}}></i>{{phone.dailingCode}}</a>

                            <div class="dropdown-menu">

                              <div class="form-check" *ngFor="let country of countries">
                                <input type="radio" [name]="phone.phoneLabel+'country'" class="form-check-input d-none"
                                  [id]="phone.phoneLabel+country.countryCodeID"
                                  [value]="phone.phoneLabel+country.countryCodeID" [(ngModel)]="phone.selectedCountry"
                                  (change)="onCountryChange(country.countryCodeID,country.dialingCode,phone.phoneLabel,country.countryCode,false)">
                                <label class="form-check-label" [for]="phone.phoneLabel+country.countryCodeID"><i
                                    [class]="getFlagClass(country.countryCodeID)"></i>{{ country.countryCode }} <span>{{
                                    country.dialingCode }}</span></label>
                              </div>

                            </div>
                          </div>
                          <input type="text" class="form-control" name="txtHomePhone_{{ i }}"
                            [(ngModel)]="phone.phoneNumber" #txtHomePhone="ngModel" [class.error-field]="
                                  txtHomePhone.invalid || phone.isErrorMessage
                                " [validation]="true" mask="{{ maskSetVal }}" (input)="
                                  onSearchChange(
                                    $event.target.value,
                                    phone.phoneLabel,
                                    phone.phoneID
                                  )
                                " />

                        </div>
                        <div class="row text-danger" *ngIf="txtHomePhone.invalid || phone.isErrorMessage">
                          <div class="val-error">
                            {{ "PHONEINVALID" | translate }}
                          </div>
                        </div>
                        }
                      </div>
                      @if(!isloading){

                      <button type="button" class="delete_btn" *ngIf="i >= 2" (click)="removeHomePhone(i)">
                        <i class="fa fa-trash" aria-hidden="true"></i>
                      </button>
                      }
                    </div>
                  </div>
                </div>
              </section>

              
              <!-- coding Stop -->
              <!-- coding Start -->

              <section *ngFor="let phone of cellphone; let i = index">
                <div class="form-group-block">
                  <div class="block_label">
                    @if(!isloading){

                    <span class="arrow_trigger" *ngIf="hideHomeCell(phone.phoneLabel)"
                      (click)="OpenCellPhonePopup(i)"><i class="fa fa-chevron-down"></i></span>
                    }
                    <label id="lblOpenCellPhonePopup_{{ i }}">{{
                      phone.phoneLabel | translate
                      }}</label>:<br />
                    @if(!isloading){

                    <span *ngIf="false" class="read-only-text">{{
                      "PRIMARY" | translate
                      }}</span>
                    }
                    <div class="dropdown-menu custom-radio-btn" (clickOutside)="labelPopupOutsideClick($event)"
                      id="idCellPhoneOpen_{{ i }}" style="top: 30px">
                      <ul class="dynLableText">
                        <li *ngFor="let dyPhoneLabel of this.phoneLabelArray">
                          <label for="{{dyPhoneLabel.cellRedioId +'_'+ i}}"
                            [ngClass]="isLabelExist(dyPhoneLabel.labelName)" *ngIf="dyPhoneLabel.labelName">
                            <input #checkboxes type="radio" id="{{dyPhoneLabel.cellRedioId +'_'+ i}}"
                              name="dyPhoneLabel_rdo" [value]="dyPhoneLabel.labelName" (change)="
                                CellDynRadioDisplayValue(
                                    $event,
                                    this.dropDownId,
                                    dyPhoneLabel.labelName
                                  )
                                " />
                            <span><i>{{fieldsShortName(dyPhoneLabel.labelName) }}</i></span>
                          </label>
                          <div class="edit-btn"
                            (click)="editLableDyn($event, dyPhoneLabel);dyPhoneLabel.editVisable=true;"
                            *ngIf="showHideLabelList(dyPhoneLabel.labelName)">
                            <i class="fa fa-pencil"></i>
                          </div>
                          <ng-container *ngIf="dyPhoneLabel.editVisable">
                        <li>
                          <div class="input_editAdd">
                            <input class="type_text label-error"
                              [ngStyle]="{'border-color': (isListLabelExist) ? '#ff0404' : 'null'}" id="editLabelData"
                              maxlength="15" placeholder="" type="text" name="editLabelData" [(ngModel)]="selectedLabel"
                              (click)="editLabelData($event)" (keyup)="removeLableError()" />
                            <div class="saveInput" [ngClass]="isEditLabelBtnDisable ?'edit-label-Btn-disable': ''"
                              (click)="saveNewPhoneLabel($event,dyPhoneLabel.cellRedioId +'_'+ i)">
                              Save
                            </div>

                          </div>
                          <span *ngIf="isListLabelExist" style="color: red;text-transform: capitalize;
                              margin-top: 3px;
                              display: block;">Duplicate Label</span>
                        </li>
                        </ng-container>
                        </li>



                        <ng-container *ngIf="addNewLabel">
                          <li>
                            <span class="input_editAdd"><input class="type_text label-error"
                                [ngStyle]="{'border-color': (isListLabelExist) ? '#ff0404' : 'null'}" id="editLabelData"
                                maxlength="15" placeholder="" type="text" name="editLabelData"
                                [(ngModel)]="selectedLabel" (click)="editLabelData($event)"
                                (keyup)="removeLableError()" />
                              <div class="saveInput" (click)="saveNewPhoneLabel($event)">
                                Save
                              </div>
                            </span>
                            <span *ngIf="isListLabelExist" style="color: red;text-transform: capitalize;
                              margin-top: 3px;
                              display: block;">Duplicate Label</span>
                          </li>
                        </ng-container>
                        <li class="addLabelBtn">
                          <div (click)="addNewPhoneLabel($event)">
                            <i class="fa fa-plus"></i> Add label
                          </div>
                        </li>
                      </ul>

                      <ul>

                      </ul>
                    </div>
                  </div>
                  <div class="block_inputs">
                    <div [ngClass]="
                        i >= 0
                          ? 'form-group with_add_btn mb-0'
                          : 'form-group mb-0'
                      ">


                      <div class="colm colm-number colm-12">
                        <div class="d-flex align-items-stretch">

                          <div class="dropdown">
                            <a href="javascript:void(0)" [class.disabled]="phone.isdisabled"
                              [ngStyle]="{'opacity': phone.isdisabled ? '0.5' : '1'}" class="dropdown-toggle"
                              data-toggle="dropdown" aria-expanded="false"><i
                                class={{phone.selectedFlag}}></i>{{phone.dailingCode}}</a>
                            <ng-container *ngIf="phone.phoneLabel != ''">
                              <div class="dropdown-menu">
                                <div class="form-check" *ngFor="let country of countries">
                                  <input type="radio" [name]="phone.phoneLabel + 'country'"
                                    class="form-check-input d-none" [id]="phone.phoneLabel + country.countryCodeID"
                                    [value]="phone.phoneLabel + country.countryCodeID"
                                    [(ngModel)]="phone.selectedCountry"
                                    (change)="onCountryChange(country.countryCodeID, country.dialingCode, phone.phoneLabel, country.countryCode, true)">
                                  <label class="form-check-label" [for]="phone.phoneLabel + country.countryCodeID"><i
                                      [class]="getFlagClass(country.countryCodeID)"></i>{{ country.countryCode }}
                                    <span>{{ country.dialingCode }}</span></label>
                                </div>

                              </div>
                            </ng-container>
                          </div>

                          <input type="text" class="form-control" name="txtCellPhone_{{ i }}"
                            [(ngModel)]="phone.phoneNumber" #txtCellPhone="ngModel" [class.error-field]="
                            txtCellPhone.invalid || phone.isErrorMessage || phone.isLabelErrorMessage
                          " [validation]="true" mask="{{ maskSetVal2 }}" (input)="
                            onSearchChange2(
                              $event.target.value,
                              phone.phoneLabel,
                              phone.phoneID
                            )
                          " />
                        </div>
                        <div class="row text-danger" *ngIf="txtCellPhone.invalid || phone.isErrorMessage">
                          <div class="val-error">
                            {{ "PHONEINVALID" | translate }}
                          </div>
                        </div>
                        <div class="row text-danger" *ngIf="phone.isLabelErrorMessage">
                          <div class="val-error">
                            Label is required
                          </div>
                        </div>
                      </div>
                      @if(!isloading){

                      <button type="button" class="delete_btn" *ngIf="i >= 0" (click)="removeCellPhone(i)">
                        <i class="fa fa-trash" aria-hidden="true"></i>
                      </button>
                      }
                      <!-- </section> -->
                     
                    </div>
                  </div>
                </div>
              </section>
              @if(!isloading){
              <div class="colm colm-12 add_btn_default">
                <button type="button" class="btn" (click)="addCellPhone()">
                  <i class="fa fa-plus" aria-hidden="true"></i>
                  <span>{{ "ADD" | translate }}</span>
                </button>
              </div>
              }


              <div class="modal-devider">
                <h4>{{ "EMAIL" | translate }}</h4>
              </div>
              <!-- coding Stop -->
              <!-- coding start -->

              <section *ngFor="let emailaddress of email; let i = index" class="home-email">
                <div class="form-group-block">
                  <div class="block_label">
                    @if(!isloading){

                    <span class="arrow_trigger" *ngIf="hideHomeEmailCell(emailaddress.emailLabel)"
                      (click)="OpenEmailPopup(i)"><i class="fa fa-chevron-down"></i></span>
                    }
                    <app-skeleton-loader-component [isLoading]="isloading" [theme]="{ width: '110px', height: '30px' }">
                      <label id="lblOpenEmailPopup_{{ i }}">{{
                        emailaddress.emailLabel | translate
                        }}</label>: </app-skeleton-loader-component><br />
                    @if(!isloading){

                    <span *ngIf="false" class="read-only-text">{{ "PRIMARY" | translate }}</span>
                    }

                    <div class="dropdown-menu custom-radio-btn" (clickOutside)="labelPopupOutsideClick($event)"
                      id="idEmailOpen_{{ i }}" style="top: 30px">
                      <ul class="dynLableText">
                        <li *ngFor="let dyEmailLabel of this.emailLabelArray">
                          <label for="{{dyEmailLabel.emailRdioId +'_'+ i}}"
                            [ngClass]="isEmailLabelExist(dyEmailLabel.labelName)" *ngIf="dyEmailLabel.labelName">

                            <input #checkboxes type="radio" id="{{dyEmailLabel.emailRdioId +'_'+ i}}"
                              name="dyEmailLabel_rdo" [value]="dyEmailLabel.labelName"
                              [(ngModel)]="dyEmailLabel.labelName" (change)="
                                EmailDynRadioDisplayValue(
                                  $event,
                                  this.dropDownId,
                                  dyEmailLabel.labelName
                                )
                              " />
                            <span><i>{{fieldsShortName(dyEmailLabel.labelName) }}</i></span>
                          </label>
                          <div class="edit-btn"
                            (click)="editEmailLabelDyn($event, dyEmailLabel);dyEmailLabel.editVisable=true;"
                            *ngIf="showHideLabelList(dyEmailLabel.labelName)">
                            <i class="fa fa-pencil"></i>
                          </div>
                          <ng-container *ngIf="dyEmailLabel.editVisable">
                        <li>
                          <div class="input_editAdd">
                            <app-skeleton-loader-component [isLoading]="isloading"
                              [theme]="{ width: '290px', height: '30px' }">
                              <input class="type_text label-error"
                                [ngStyle]="{'border-color': (isEmailListLabelExist) ? '#ff0404' : 'null'}"
                                id="editLabelData" maxlength="15" placeholder="" type="text" name="editLabelData"
                                [(ngModel)]="selectedEmailLabel" (click)="editLabelData($event)"
                                (keyup)="removeEmailLabelError()" /></app-skeleton-loader-component>
                            <div class="saveInput" [ngClass]="isEmailEditLabelBtnDisable ?'edit-label-Btn-disable': ''"
                              (click)="saveNewEmailLabel($event,dyEmailLabel.emailRdioId +'_'+ i)">
                              Save
                            </div>

                          </div>
                          <span *ngIf="isEmailListLabelExist" style="color: red;text-transform: capitalize;
                            margin-top: 3px;
                            display: block;">Duplicate Label</span>
                        </li>
                        </ng-container>
                        </li>

                        <ng-container *ngIf="addNewLabel">
                          <li>
                            <span class="input_editAdd"><input class="type_text label-error"
                                [ngStyle]="{'border-color': (isEmailListLabelExist) ? '#ff0404' : 'null'}"
                                id="editLabelData" maxlength="15" placeholder="" type="text" name="editLabelData"
                                [(ngModel)]="selectedEmailLabel" (click)="editLabelData($event)"
                                (keyup)="removeEmailLabelError()" />
                              <div class="saveInput" (click)="saveNewEmailLabel($event)">
                                Save
                              </div>
                            </span>
                            <span *ngIf="isEmailListLabelExist" style="color: red;text-transform: capitalize;
                            margin-top: 3px;
                            display: block;">Duplicate Label</span>
                          </li>
                        </ng-container>
                        <li class="addLabelBtn">
                          <div (click)="addNewEmailLabel($event)">
                            <i class="fa fa-plus"></i> Add label
                          </div>
                        </li>
                      </ul>
                  
                    </div>
                  </div>
                  <div class="block_inputs">
                    <div [ngClass]="
                        i >= 1
                          ? 'form-group with_add_btn mb-0'
                          : 'form-group mb-0'
                      ">
                      <!-- <section *ngFor="let emailaddress of email; let i = index;"> -->
                      <div class="colm colm-12">
                        <app-skeleton-loader-component [isLoading]="isloading"
                          [theme]="{ width: '420px', height: '30px' }">
                          <input type="email" class="form-control" [ngClass]="[
                            emailaddress.invalid || emailaddress.isLabelErrorMessage ? 'error-field' : ''
                          ]" name="txtEmailAddress_{{ i }}" (focusout)="ValidDonorKeyPress($event, 'email')"
                            [(ngModel)]="emailaddress.emailAddress" #txtEmailAddress="ngModel" />
                          <div *ngIf="emailaddress.invalid" class="row text-danger">
                            <div class="val-error">
                              {{ "EMAILINVALID" | translate }}
                            </div>
                          </div>
                        </app-skeleton-loader-component>
                        <div class="row text-danger" *ngIf="emailaddress.isLabelErrorMessage">
                          <div class="val-error">
                            Label is required
                          </div>
                        </div>
                      </div>
                      @if(!isloading){

                      <button type="button" class="delete_btn" *ngIf="i >= 1" (click)="removeEmailAddress(i)">
                        <i class="fa fa-trash" aria-hidden="true"></i>
                      </button>
                      }

                      <!-- </section> -->
                     
                    </div>
                  </div>
                </div>
              </section>
              @if(!isloading){
              <div class="colm colm-12 add_btn_default add-btn-email">
                <button type="button" class="btn" (click)="addEmailAddress()">
                  <i class="fa fa-plus" aria-hidden="true"></i>
                  <span>{{ "ADD" | translate }}</span>
                </button>
              </div>
              }
              <!-- coding stop -->
              

            </div>
            <div class="action_footer">
              <div class="left_part">
                <button class="btn btn-remove" type="button" (click)="deleteDonor()" *ngIf="isEditMode">
                  {{ "DELETEDONOR" | translate }}
                </button>
              </div>
              <div class="right_part">
                <button *ngIf="commonMethodService.isfeatureSetting" class="btn btn-for-disable" type="submit"
                  [disabled]="
                    !formValid || !ff.form.valid || isDuplicateAccNumber || isDisableSaveButton() || !areAllDropdownsSelected()
                  ">
                  {{ "SAVE" | translate }}
                </button>
                <button class="btn btn-for-disable btn-core" (click)="onUpgrade($event)"
                  *ngIf="!this.commonMethodService.isfeatureSetting">
                  {{ "UPGRADETOSAVE" | translate }}
                </button>
              </div>
            </div>
            <div *ngIf="commonMethodService.loaderSearch" class="card-overlay">
              <i class="fas fa-2x fa-sync-alt fa-spin"></i>
            </div>
          </div>
        </form>
      </div>

      <div class="tab-pane" id="advancedFields" role="tabpanel" [ngClass]="{'active': activeTab === 'advancedfield'}">
        <form class="form--wrap" name="donorInfoForm" (ngSubmit)="f.form.valid && SaveDonorInfo()" #f="ngForm">
          <div class="inside_wrap">
            <div class="field-advanced-form">
              <div class="field-advanced-wrap">
                <div *ngIf="advancedFieldValues && advancedFieldValues.length != 0">
                  <div class="form-group-block" *ngFor="let data of advancedFieldValues; let i = index">
                    <div class="form-group">
                      <div class="block_label">
                        <app-skeleton-loader-component [isLoading]="isloading"
                          [theme]="{ width: '90px', height: '30px' }">
                          <span class=" hidden-mobile m-0"><span class="m-0" [ngClass]="
                              contains_hebrew(data.advancedField.fieldName)
                            ">{{ data.advancedField.fieldName }}</span></span>

                          <label class="hidden-desktop" [ngClass]="
                              contains_hebrew(data.advancedField.fieldName)
                            ">{{ data.advancedField.fieldName }}</label>
                        </app-skeleton-loader-component>
                      </div>

                      <div class="block_inputs block_inputs_btn_group" *ngIf="data.advancedField.type == 'text'">
                        @if (isloading) {

                        <app-skeleton-loader-component [isLoading]="isloading"
                          [theme]="{ width: '400px', height: '30px' }">

                        </app-skeleton-loader-component>}
                        @else {

                        <input type="text" name="textnewField_{{ i }}" class="form-control" [(ngModel)]="data.value" />}
                      
                        <div class="advanced-dropdown hidden-desktop position-relative ml-3"
                          (clickOutside)="onClickedOutsideAdvance(i)">
                          <span class="advanced-btn" (click)="advancedDropdown(i)">...</span>
                          <ul class="advanced-ul" *ngIf="data.advancedDropdownMenu">
                            <li (click)="
                              onEditPopupAdvancedField(
                                data.advancedField.advancedFieldId
                              )
                            ">
                              <span class="material-icons">edit</span> Edit field type
                            </li>
                            <li class="delete-btn" (click)="
                              removeAdvanceField(
                                data.advancedField.advancedFieldId,
                                i
                              )
                            ">
                              <span class="fa fa-trash"></span> Remove field
                            </li>
                          </ul>
                        </div>

                      </div>

                      <div class="block_inputs block_inputs_btn_group" *ngIf="data.advancedField.type == 'dropdown'">
                        @if (isloading) {

                        <app-skeleton-loader-component [isLoading]="isloading"
                          [theme]="{ width: '400px', height: '30px' }">

                        </app-skeleton-loader-component>}
                        @else {


                        <select [(ngModel)]="data.value" name="drpnewField_{{ i }}" class="form-control">
                          <option value="null">
                            {{ "SELECT" | translate }}
                          </option>
                          <option *ngFor="let item of data.advancedField.options" [ngClass]="
                              contains_hebrew(data.advancedField.fieldName)
                            " [value]="item">
                            {{ item }}
                          </option>
                        </select>
                        }
                       

                        <div class="advanced-dropdown hidden-desktop position-relative ml-3"
                          (clickOutside)="onClickedOutsideAdvance(i)">
                          <span class="advanced-btn" (click)="advancedDropdown(i)">...</span>
                          <ul class="advanced-ul" *ngIf="data.advancedDropdownMenu">
                            <li (click)="
                              onEditPopupAdvancedField(
                                data.advancedField.advancedFieldId
                              )
                            ">
                              <span class="material-icons">edit</span> Edit field type
                            </li>
                           
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group-block">

                  <div class="form-group add_new_field">
                    <div class="block_label"></div>
                    <div class="block_inputs">

                      <ul class="dropdown-menu create-donor-block" role="menu" aria-labelledby="dropdownMenu">
                        <li (click)="AddAdvanceField('text')">
                          <i class="fas fa-font"></i>{{ "TEXTFIELD" | translate }}
                        </li>
                        <li class="arrow-icon" (click)="AddAdvanceField('dropdown')">
                          <i class="fas fa-caret-down"></i>{{ "DROPDOWN" | translate }}
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="action_footer">
            <div class="left_part">
              <button *ngIf="isEditMode &&commonMethodService.isfeatureSetting" class="btn btn-remove" type="button"
                (click)="deleteDonor()">
                {{ "DELETEDONOR" | translate }}
              </button>
            </div>
            <div class="right_part">
              <button class="btn" [disabled]="!formValid || isDisableSaveButton() || !areAllDropdownsSelected()">
                {{ "SAVE" | translate }}
              </button>
            </div>
          </div>
        </form>
      </div>

      <div class="tab-pane" id="editfamilyTree" role="tabpanel" [ngClass]="{'show active': activeTab === 'familytree'}">
        <form class="form--wrap" name="donorInfoForm" (ngSubmit)="ff.form.valid && SaveDonorInfo()" #ff="ngForm">
          <div class="family_tree_main rtl-lang family_tree">
            <div class="inside_wrap">
              <div class="card_block">
                <h5>{{ "YOURFAMILY" | translate }}</h5>

                <div class="form-group edtpayment_drp" [ngClass]="displaySearchIconFather ? 'form-group-search':'' ">
                  @if (isloading) {
                  <label class="lng_hebrew"><app-skeleton-loader-component [isLoading]="isloading"
                      [theme]="{ width: '100%', height: '42px', margin:'0'}"></app-skeleton-loader-component></label>}
                  @else {
                  <label class="lng_hebrew">אב</label>
                  }

                  <div class="flex-fill">
                    @if (isloading) {
                    <app-skeleton-loader-component [isLoading]="isloading"
                      [theme]="{ width: '100%', height: '42px', margin:'0' }"></app-skeleton-loader-component>}
                    @else {
                    <input type="text" class="form-control" id="txtFatherName" name="txtFatherName" [(ngModel)]="father"
                      (input)="SearchDonorFatherNew($event)" />
                    }
                  </div>
                  <span *ngIf="isRemoveFather" class="cancel_icon" (click)="RemoveFather()">
                    <i class="fa fa-times" aria-hidden="true"></i>
                  </span>

                  <span class="search_icon" *ngIf="displaySearchIconFather" (click)="searchGlobalFatherDonar()">
                    <i class="fa fa-search" aria-hidden="true"></i>
                  </span>

                  <label class="switch global_list_togle" *ngIf="!isRemoveFather" data-toggle="tooltip" appHoverTooltip
                    labelText="{{'SWTICHLABELTOOLTIP' | translate}}">
                    <input type="checkbox" class="global_chck" id="globallist"
                      (change)="OnGlobalCheckboxChangeFather($event)">
                    <span class="slider round"></span>
                    <div class="toggel-switch-loader" style="background: #fafafa;height: 32px;"
                      *ngIf="this.commonMethodService.isLoaderNewTrans">
                      <div class="loader_img">
                        <img src="/assets/img/loader.svg" alt="loader" />
                      </div>
                    </div>
                  </label>
                  <div class="donor_infolist" (clickOutside)="onClickedOutside()"
                    *ngIf="commonMethodService.donorList.length != 0 && showBoxFather">
                    <div class="donor_row" *ngFor="let item of commonMethodService.donorList"
                      (click)="SelectDonorFather(item.id)">
                      <app-donor-list-template [donorObj]="item"></app-donor-list-template>
                    </div>
                  </div>
                </div>

                <div class="form-group edtpayment_drp"
                  [ngClass]="displaySearchIconFatherInLaw ? 'form-group-search':'' ">
                  @if (isloading) {
                  <label class="lng_hebrew"><app-skeleton-loader-component [isLoading]="isloading"
                      [theme]="{ width: '100%', height: '42px', margin:'0' }"></app-skeleton-loader-component></label>}
                  @else {
                  <label class="lng_hebrew">חמיו</label>}

                  <div class="flex-fill">
                    @if (isloading) {
                    <app-skeleton-loader-component [isLoading]="isloading"
                      [theme]="{ width: '100%', height: '42px', margin:'0' }"></app-skeleton-loader-component>}
                    @else {
                    <input type="text" class="form-control" id="txtFatherInLawName" name="txtFatherInLawName"
                      [(ngModel)]="fatherInLaw" (input)="SearchDonorFatherInLawNew($event)" />}
                  </div>
                  <span *ngIf="isRemoveFatherInLaw" class="cancel_icon" (click)="RemoveFatherInLaw()">
                    <i class="fa fa-times" aria-hidden="true"></i>
                  </span>

                  <span class="search_icon" *ngIf="displaySearchIconFatherInLaw"
                    (click)="searchGlobalFatherDonarInLaw()">
                    <i class="fa fa-search" aria-hidden="true"></i>
                  </span>

                  <label class="switch global_list_togle" *ngIf="!isRemoveFatherInLaw" data-toggle="tooltip"
                    appHoverTooltip labelText="{{'SWTICHLABELTOOLTIP' | translate}}">
                    <input type="checkbox" class="global_chck" id="globallistfatherInLaw"
                      (change)="OnGlobalCheckboxChangeFatherInLaw($event)">
                    <span class="slider round"></span>
                    <div class="toggel-switch-loader" style="background: #fafafa;height: 32px;"
                      *ngIf="this.commonMethodService.isLoaderNewTrans">
                      <div class="loader_img">
                        <img src="/assets/img/loader.svg" alt="loader" />
                      </div>
                    </div>
                  </label>
                  <div class="donor_infolist" (clickOutside)="onClickedOutside()"
                    *ngIf="commonMethodService.donorList.length != 0 && showBoxFatherInLaw">
                    <div class="donor_row" *ngFor="let item of commonMethodService.donorList"
                      (click)="SelectDonorFatherInLaw(item.id)">
                      <app-donor-list-template [donorObj]="item"></app-donor-list-template>
                    </div>
                  </div>
                </div>


                <!-- code for add new member started -->

                <section *ngFor="let family of familiesInput; let i = index" class="home-email">
                  <div class="form-group-block">

                    <div class="block_inputs">
                      <div class="form-group with_add_btn mb-0">
                        <!-- code for family started -->

                        <app-skeleton-loader-component [isLoading]="isloading" *ngIf="isloading"
                          [theme]="{ width: '70px', height: '42px', margin:'0 0 0 18px' }"></app-skeleton-loader-component>

                        <select [class.hidden]="isloading" [(ngModel)]="family.selectedValue"
                          [id]="family.familySelectedValue" [name]="family.familySelectedValue"
                          #selectDropdown="ngModel" name="first">
                          <option *ngFor="let option of options" [value]="option">{{ option }}</option>
                        </select>



                        <div class="form-group edtpayment_drp"
                          [ngClass]="family.isDisplaySearchIcon ? 'form-group-search':'' ">
                          <label class="lng_hebrew"></label>

                          <div class="flex-fill">
                            @if (isloading) {
                            <app-skeleton-loader-component [isLoading]="isloading"
                              [theme]="{ width: '100%', height: '42px', margin:'0'}"></app-skeleton-loader-component>}
                            @else {
                            <input type="text" class="form-control" [id]="family.familyNameInputName"
                              [name]="family.familyNameInputName" [(ngModel)]="family.familyName"
                              (input)="SearchDonorNew($event , family.familyGlobalList , i)" />
                            }
                          </div>

                          <span *ngIf="family.showCancelIcon" class="cancel_icon" (click)="RemoveDonor(i , $event)">
                            <i class="fa fa-times" aria-hidden="true"></i>
                          </span>

                          <span class="search_icon" *ngIf="family.isDisplaySearchIcon"
                            (click)="searchGlobalDonar(family.familyNameInputName , i)">
                            <i class="fa fa-search" aria-hidden="true"></i>
                          </span>

                          <label class="switch global_list_togle" *ngIf="!family.showCancelIcon" data-toggle="tooltip"
                            appHoverTooltip labelText="{{'SWTICHLABELTOOLTIP' | translate}}">
                            <input type="checkbox" class="global_chck" [id]="family.familyGlobalList"
                              (change)="OnGlobalCheckbox($event , i)">
                            <span class="slider round"></span>
                          </label>

                          <div class="donor_infolist"
                            *ngIf="commonMethodService.donorList.length != 0 && family.isShowBox">
                            <div class="donor_row" *ngFor="let item of commonMethodService.donorList"
                              (click)="SelectDonor(item.id , i)">
                              <app-donor-list-template [donorObj]="item"></app-donor-list-template>
                            </div>
                          </div>
                        </div>

                        @if (isloading) {
                        <app-skeleton-loader-component [isLoading]="isloading"
                          [theme]="{ width: '50px', height: '42px', margin:'0 10px 0 0' }"></app-skeleton-loader-component>
                        } @else {
                        <button type="button" class="delete_btn" *ngIf="i >= 0" (click)="removeFamilies(i , family)">
                          <i class="fa fa-trash" aria-hidden="true"></i>
                        </button>
                        }


                        <div class="error w-100"
                          *ngIf="family.selectedValue == null && family.isSelectDynamicDonar || family.selectedValue == null && selectDropdown?.touched">
                          Please select a value from dropdown.
                        </div>


                        <div class="error w-100" *ngIf="!family.isSelectDynamicDonar && family.isDynamicTextAdding">
                          Please select a donor from the list
                        </div>
                        <!-- code for family ended -->
                      </div>
                    </div>

                  </div>
                </section>
                @if(!isloading){
                <div class="colm colm-12 add_btn_default add-btn-email">
                  <button type="button" class="btn" (click)="addFamilies()">
                    <i class="fa fa-plus" aria-hidden="true"></i>
                    <span>{{ "ADD FAMILY MEMBER" | translate }}</span>
                  </button>
                </div>}
                <!-- code for add new member ended -->

              </div>
            </div>
            <div class="action_footer">
              <div class="left_part">
                <button class="btn btn-remove" type="button" (click)="deleteDonor()" *ngIf="isEditMode">
                  {{ "DELETEDONOR" | translate }}
                </button>
              </div>
              <div class="right_part">
                <button *ngIf="commonMethodService.isfeatureSetting" class="btn"
                  [disabled]="!formValid || isDisableSaveButton() || !areAllDropdownsSelected()" type="button"
                  (click)="ff.form.valid && SaveDonorInfo()">
                  {{ "SAVE" | translate }}
                </button>
              </div>
            </div>

            <div *ngIf="commonMethodService.loaderSearch" class="card-overlay">
              <i class="fas fa-2x fa-sync-alt fa-spin"></i>
            </div>
          </div>
        </form>
      </div>

      <div class="tab-pane" id="tagsPan" role="tabpanel" [ngClass]="{'show active': activeTab === 'tags'}">
        <form class="form--wrap" name="donorInfoForm" (ngSubmit)="f.form.valid && SaveDonorInfo()" #f="ngForm">
          <div class="badge_wrapper">
            <ng-container *ngFor="let itemTag of donorTagList; let i = index">
              <!-- <p>{{itemTag | json }}</p> -->
              <div *ngIf="itemTag.statusId != -1" class="badge position-relative" [ngClass]="
                  commonMethodService.getTagBackgroundColor(itemTag.tagColor)
                ">
                {{ tagService.formatTagName(itemTag.tagName) }}

                <span class="badge-btn" (click)="tagsDropdown(i)" (clickOutside)="onClickedOutsideTag(i)">...</span>

                <ul class="advanced-ul" *ngIf="itemTag.tagsDropdownMenu">
                  <li>
                    <button type="button" (click)="onTagEdit(itemTag.tagId)"> <span class="material-icons">edit</span>
                      Edit tag type
                    </button>
                  </li>
                  <li class="delete-btn">
                    <button type="button" (click)="onTagDelete(itemTag.tagId)">
                      <span class="fa fa-trash"></span> Remove tag
                    </button>
                  </li>
                </ul>
                <button type="button" class="fas fa-times hidden-mobile" (click)="onTagDelete(itemTag.tagId)"></button>
              </div>
            </ng-container>

            <div class="badge bg-new-tag dropdown">
              <button class="dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown"
                aria-haspopup="true" aria-expanded="false">
                <i class="fa fa-plus"></i> {{ "ADDNEWTAG" | translate }}
              </button>
              <div class="dropdown-menu tabg_dropdown" aria-labelledby="dropdownMenuButton">
                <div class="search_box">
                  <input type="text" [formControl]="tagSearchQuery" placeholder="{{ 'SEARCHTAG' | translate }}" class="form-control" />
                </div>
                <ul>
                  <ng-container *ngFor="let itemTag of newDonorTagList">
                    <li style="cursor: pointer" [ngClass]="
                        commonMethodService.getTagTextColor(itemTag.tagColor)
                      " (click)="onSelectTag(itemTag.tagId)">
                      <span class="bg-badge" [ngClass]="
                          commonMethodService.getTagBackgroundColor(
                            itemTag.tagColor
                          )
                        "></span>
                      <span class="text">{{
                        tagService.formatTagName(itemTag.tagName)
                        }}</span>
                    </li>
                  </ng-container>
                </ul>
                <!-- <button type="button" class="add-new-tag" (click)="AddNewTag()">
                  <i class="fa fa-plus"></i> {{ "ADDNEWTAG" | translate }}
                </button> -->
              </div>
            </div>

            <div *ngIf="commonMethodService.loaderSearch" class="card-overlay">
              <i class="fas fa-2x fa-sync-alt fa-spin"></i>
            </div>
          </div>

          <!-- Footer Buttons -->
          <div class="action_footer">
            <div class="left_part">
              <button class="btn btn-remove" type="button" (click)="deleteDonor()" *ngIf="isEditMode">
                {{ "DELETEDONOR" | translate }}
              </button>
            </div>
            <div class="right_part">
              <button *ngIf="commonMethodService.isfeatureSetting" class="btn"
                [disabled]="!formValid || isDisableSaveButton() || !areAllDropdownsSelected()" type="button"
                (click)="f.form.valid && SaveDonorInfo()">
                {{ "SAVE" | translate }}
              </button>
            </div>
          </div>
          <!-- Footer Buttons -->
        </form>
      </div>

      <div class="tab-pane" id="tab-location" role="tabpanel" [ngClass]="{'show active': activeTab === 'location'}">
        <!--Add location button code started  -->
        <div class="badge_wrapper">
          <div class="badge bg-new-tag dropdown">
            <button class="dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown"
              aria-haspopup="true" aria-expanded="false" (click)="ClickedAddLocation()">
              <i class="fa fa-plus"></i> {{ "ADDLOCATION" | translate }}
            </button>

            <div class="dropdown-menu tabg_dropdown" aria-labelledby="dropdownMenuButton"
              (click)="dropdownHideAndShow(isLocationClicked, $event)">
              <!-- started switch code  -->
              <div class="modal__custom_content_inside">
                <div class="content__inside">
                  <div class="field_content">
                    <div class="input_group" data-toggle="modal">
                      <input type="text" class="form-control" placeholder="{{ 'SEARCHLOCATIONS' | translate }}"
                        (input)="searchLocations($event.target.value)" [(ngModel)]="locationSearchText" />

                      <button class="search_btn hover_tooltip" *ngIf="locationSearchText?.length < 3 && displaySearchIcon"
                        data-toggle="tooltip" t-title="Need to be more then 3 characters" type="button"
                        [disabled]="locationSearchText?.length < 3" (click)="SearchGlobalPaymentLocation()">
                        {{ "SEARCH" | translate }}
                      </button>

                      <button class="search_btn hover_tooltip" *ngIf="locationSearchText?.length >= 3 && displaySearchIcon"
                        data-toggle="tooltip" type="button" (click)="SearchGlobalPaymentLocation()">
                        {{ "SEARCH" | translate }}
                      </button>

                      <label class="switch global_list_togle" data-toggle="tooltip"
                        t-title="Turn on switch to include search in Global List, you need to press enter or click on the search button">
                        <input type="checkbox" class="global_chck" [(ngModel)]="globalCheckbox" (change)="OnCheckboxChange($event)" />
                        <span class="slider round"></span>
                        <div class="toggel-switch-loader" *ngIf="this.commonMethodService.isLoaderNewTrans">
                          <div class="loader_img">
                            <img src="/assets/img/loader.svg" alt="loader" />
                          </div>
                        </div>
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- ended switch code -->
              <div *ngIf="showDropdown == true">
                <ul>
                  <ng-container *ngFor="let location of filteredLocations">
                    <li style="cursor: pointer" (click)="AddLocation(location.locationID)">
                      <span>{{ location.locationName }}</span>
                      <span>{{ location.address }}</span>
                    </li>
                  </ng-container>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <!--Add location button code ended -->
        <div class="inside_wrap" style="min-height: 270px">
          <div class="row payment__list_main">
            <div class="col-12 col-sm-12 col-lg-12">
              <ng-container *appIsWeb>
                <div class="table-responsive transaction__table">
                  <div class="donor-data-list-wrap">
                    <div class="table__main">
                      <table cellpadding="0" cellspacing="0" border="0" [svData]="lstLocation" #sv="svDataTable"
                        [svRowsOnPage]="10" svSortBy="locationName" svSortOrder="asc">
                        <thead>
                          @if (isloading) {
                          <tr>
                            <th>
                              <app-skeleton-loader-component [isLoading]="isloading"
                                [theme]="{ width: '100%', height: '30px', margin: '0' }"></app-skeleton-loader-component>
                            </th>
                          </tr>
                          }
                          @else {
                          <tr>
                            <th>{{ "LOCATIONNAME" | translate }}</th>
                            <th>{{ "ADDRESS" | translate }}</th>
                            <th>{{ "CITY" | translate }}</th>
                            <th>{{ "STATE" | translate }}</th>
                            <th>{{ "COUNTRY" | translate }}</th>
                            <th>{{ "ZIP" | translate }}</th>
                            <th></th>
                          </tr>}
                        </thead>
                        @if(lstLocation?.length > 0){

                        <tbody>

                          <tr *ngFor="let item of lstLocation; let i = index">

                            <td (click)="openLocationCard(item.locationId)" class="blueviolet">
                              {{ item.locationName }}
                            </td>
                            <td>{{ item.address }}</td>
                            <td>{{ item.city }}</td>
                            <td>{{ item.state }}</td>
                            <td>{{ item.country }}</td>
                            <td>{{ item.zip }}</td>
                            <td class="text-danger" (click)="
                                  DeleteDonorLocation(item.accountLocationId)
                                ">
                              <i class="fa fa-trash"></i>
                            </td>

                          </tr>

                        </tbody>
                        }
                        @if (isloading) {

                        <tbody>
                          <ng-container *ngFor="let item of skeletonitems2">

                            <tr>

                              <td><app-skeleton-loader-component [isLoading]="isloading"
                                  [theme]="{ width: '100%', height: '30px', margin: '0' }"></app-skeleton-loader-component>
                              </td>
                          </ng-container>

                        </tbody>
                        }
                      </table>
                    </div>
                  </div>
                </div>
              </ng-container>
              <ng-container *appIsMobile>
                <ul class="location-list" *ngIf="lstLocation?.length > 0">
                  <li *ngFor="let item of lstLocation; let i = index">
                    <span class="location-head"> {{ item.locationName }}</span>
                    <span class="location-desc">{{ item.address }} {{ item.city }} {{ item.state }} {{ item.country }}
                      {{ item.zip }}</span>
                    <span class="fa fa-trash remove-list" (click)="
                      DeleteDonorLocation(item.accountLocationId)
                    "></span>
                  </li>
                </ul>
              </ng-container>
            </div>
          </div>
        </div>
        <!-- Footer Buttons -->

        <div class="action_footer">
          <div class="left_part">
            <button class="btn btn-remove" type="button" (click)="deleteDonor()" *ngIf="isEditMode">
              {{ "DELETEDONOR" | translate }}
            </button>
          </div>
          <div class="right_part">
            <button *ngIf="commonMethodService.isfeatureSetting" class="btn"
              [disabled]="!formValid || isDisableSaveButton() || !areAllDropdownsSelected()" type="button"
              (click)="f.form.valid && SaveDonorInfo()">
              {{ "SAVE" | translate }}
            </button>
          </div>
        </div>
        <!-- Footer Buttons -->
      </div>
    </div>
    <!-- Tab content end -->
  </div>
  <!-- Modal content end -->
</div>