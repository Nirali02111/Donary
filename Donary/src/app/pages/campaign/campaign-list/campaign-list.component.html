<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper" ngbAutofocus  tabindex="-1">
    <!-- Content Header (Page header) -->
    <section class="content">
        <div class="container-fluid">
            <div class="card">
                <div class="card-body">
                    <div class="filters__options">
                        <div class="search_opts  searchdonor_opts">
                            <div class="colm searcg_txt">
                                <input type="text" name="advanceSearch" id="searchCampaign" class="form-control float-right" placeholder="{{'SEARCHCAMPAIGNS' | translate}}"  (keyup)="searchFull($event.target.value)">
                            </div>
                             <div class="filter_field" >
                                <button type="button" (click)="openSearchFilterPopup()" class="btn btn-default">
                                    <span class="filter_count" *ngIf="filtercount!=0">{{filtercount}}</span>
                                    <span class="filter_text">{{'FILTER' | translate}}</span>
                                </button>
                            </div>
                                <ng-template [ngIf]="isTotalPanelVisible">
                                    <div class="subby_dropdown">
                                        <span>{{'SUMBY' | translate}}:</span>
                                        <div class="custo_selct">
                                            <angular2-multiselect id="ddlCardType"
                                                [settings]="commonMethodService.setDropDownSettings('',1,false,true,false)"
                                                [data]="cardFilter"
                                                (onSelect)="cardTypeChange(cardType)"
                                                [(ngModel)]="cardType"
                                            >
                                                <c-item>
                                                    <ng-template let-item="item">
                                                        <label>{{item.itemName}}</label>
                                                        <span class="count_span">({{item.counts}})</span>
                                                    </ng-template>
                                                </c-item>
                                            </angular2-multiselect>
                                        </div>
                                    </div>
                                    <div class="sort_sumcard">
                                        <span class="sorting_icon"></span>
                                        <div class="custo_selct sort_drpdown">
                                            <angular2-multiselect id="ddlCardType"
                                            [settings]="commonMethodService.setDropDownSettings('',1,false,true,true)"
                                            [data]="sortFilter"
                                            (onSelect)="changeSortType(sortType)"
                                            [(ngModel)]="sortType">
                                        </angular2-multiselect>
                                        </div>
                                    </div>
                                    <ng-template #popContent 
                                    ><app-common-hebrew-english-calendar [pageName]="PageName" [data]="selectedDateRange" [isOneDate]="isOneDate"></app-common-hebrew-english-calendar>
                                    </ng-template>
                                    <div class="input-group date_picker" (clickOutside)="onClickedOutsidePopover(p1)" #p1="ngbPopover" container="body" popoverClass="calender-modal" [ngbPopover]="popContent"  [popoverTitle]="popTitle"   [autoClose]="false" placement="bottom left right start end bottom-start bottom-end end-top end-bottom" (click)="openHebrewCalendarPopup()" id="campaignDynamicsCalender">
                                        <input type="text" class="form-control" value=""
                                          [placeholder]="EngHebCalPlaceholder" />
                                        <div class="input-group-append">
                                          <span class="input-group-text">
                                            <i class="far fa-calendar-alt ngx-daterangepicker-action"></i>
                                          </span>
                                        </div>
                                    </div>
                                    <!-- calendar code ended -->
                                </ng-template>

                        </div>
                        <div class="right_colms">
                            <ng-template [ngIf]="isTotalPanelVisible">
                                <div class="loct_showall">
                                    <label class="switch">
                                        <input type="checkbox" checked (change)="OnCheckboxChange($event)" >
                                        <span class="slider round"></span>
                                      </label>
                                      <span class="show_all">{{'SHOWONLYACTIVE' | translate}} {{'CAMPAIGN' | translate}}</span>
                            </div>
                        </ng-template>
                    <div class="total_btn colm" *ngIf="showTotalPanelPermission">
                        <button class="btn btn-primary" (click)="TogglePanel(isTotalPanelVisible)">{{panelTitle | translate }}</button>
                    </div>
                            <div class="colm tbl_field">
                                <div class="dropdown">
                                        <button id="dLabel" type="button" class="btn btn-default dropdown-toggle"
                                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <i class="fas fa-tag"> <span>  {{'FIELDS' | translate}}

                                            </span></i>
                                        </button>
                                        <ng-container *ngIf="!isTabulator">

                                            <div cdkDropList [cdkDropListData]="colFields" class="field_dropdown dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                <div cdkDropListGroup  *ngFor="let group of colFields" cdkDrag [cdkDragData]="group">
                                                    <ng-template [ngIf]="group.isTotalPanel">
                                                        <h3 [ngClass]="group.class">{{group.title | translate}}</h3>
                                                        <ul cdkDropList  class="field_ul" id={{group.id}} [cdkDropListData]="group.items"  (cdkDropListDropped)="dropGroupItem($event)" role="menu" aria-labelledby="dropdownMenu">
                                                            <li class="example-box" *ngFor="let item of group.items" (click)="$event.stopPropagation();" cdkDrag [cdkDragData]="item" class="dropdown" style="list-style:none;">
                                                                <div class="fieldlst_chkbox" style="padding-left: 50px;" >
                                                                    <input type="checkbox"  class="fields_chkbx" class="" [(ngModel)]="item.isVisible"
                                                                    (change)="setGridColVisibility($event,item.colName,item.isVisible)" [id]="item.colId">
                                                                    <label  class="fields_lbl" [for]="item.colId">{{item.colName | translate }}</label>
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </ng-template>
                                                </div>
                                            </div>
                                        
                                        </ng-container>

                                        <ng-container *ngIf="isTabulator">

                                            <div class="field_dropdown dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                                <div>
    
                                                    <ul cdkDropList  
                                                        class="field_ul" 
                                                        [cdkDropListData]="columnNames"  
                                                        (cdkDropListDropped)="dropNew($event)" 
                                                        role="menu" 
                                                        aria-labelledby="dropdownMenu"
                                                    >
                                                        <li 
                                                            cdkDrag 
                                                            class="dropdown example-box"  
                                                            (click)="$event.stopPropagation();" 
                                                            [cdkDragDisabled]="objcolField.frozen"
                                                            style="list-style:none;"
                                                            *ngFor="let objcolField of columnNames"
                                                        >
                                                            <div class="fieldlst_chkbox" style="padding-left: 50px;" *ngIf="objcolField.formatter !== 'rowSelection' && !objcolField.isTotalPanel">
                                                                <input 
                                                                    type="checkbox"  
                                                                    class="fields_chkbx" 
                                                                    [(ngModel)]="objcolField.visible"
                                                                    (change)="setGridColVisibilityNew(objcolField)" 
                                                                    [id]="objcolField.field + '_campaign_lst'"
                                                                >
                                                                <label  class="fields_lbl" [for]="objcolField.field + '_campaign_lst'">
                                                                    {{ objcolField.title | translate}} 
                                                                </label>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                </div>
    
                                                <div *ngIf="isTotalPanelVisible">                                                
                                                    <h3  class="total_pnl_lbl" >{{ 'TOTALPANEL' | translate}}</h3>
                                                    <ul cdkDropList  
                                                        class="field_ul" 
                                                        [cdkDropListData]="columnNames"  
                                                        (cdkDropListDropped)="dropNew($event)" 
                                                        role="menu" 
                                                        aria-labelledby="dropdownMenu"
                                                    >
                                                        <li 
                                                            *ngFor="let objcolField of columnNames"
                                                            class="dropdown example-box"  
                                                            style="list-style:none;"
                                                            (click)="$event.stopPropagation();" 
                                                            cdkDrag 
                                                            [cdkDragDisabled]="objcolField.frozen"
                                                        >
                                                            <div class="fieldlst_chkbox" style="padding-left: 50px;" *ngIf="objcolField.isTotalPanel">
                                                                <input 
                                                                    type="checkbox"  
                                                                    class="fields_chkbx" 
                                                                    [(ngModel)]="objcolField.visible"
                                                                    (change)="setGridColVisibilityNew(objcolField)" 
                                                                    [id]="objcolField.field + '_cmp_tpl'"
                                                                >
                                                                <label  class="fields_lbl" [for]="objcolField.field + '_cmp_tpl'">
                                                                    {{ objcolField.title | translate}} 
                                                                </label>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        
                                        </ng-container>

                                        
                                </div>
                            </div>
                            <div class="colm extra_opts">
                                <div class="dropdown dropleft">
                                    <button type="button"   appHoverTooltip labelText="{{'MOREACTIONS' | translate}}" class="btn btn-default" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        <span>...</span>
                                    </button>
                                    <ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
                                        <li class="dropdown">
                                            <a class="dropdown-item" data-toggle="modal" data-target="#import-campaign-data" ><i class="fas fa-file-import"></i> {{'IMPORT'|translate}}</a>
                                        </li>
                                        <hr class="seprator" />
                                        <li class="dropdown"><a class="dropdown-item" [ngClass]="{'opacity-50':gridFilterData==null || gridFilterData.length == 0}"  (click)="gridFilterData != null && gridFilterData.length > 0 && downloadExcel()"><i class="fas fa-file-excel"></i> {{'EXCEL'|translate}}</a></li>
                                        <li class="dropdown">
                                          <a class="dropdown-item" (click)="SaveLayout()"
                                            ><i class="fa fa-tags"></i> {{ "SAVELAYOUT" | translate }}</a
                                          >
                                        </li>
                                    </ul>
                                </div>
                            </div>
            </div>
                    </div>


                    <ng-template [ngIf]="isTotalPanelVisible">
                        <div class="row">
                            <div class="col-12">
                               <!-- chip cards with slider -->
                                <ngx-slick class="carousel sumcard-wrapper" #slickModal="slick-modal" [config]="slideConfig" >
                                    <ng-container *ngFor="let item of paymentTypeChipData; let i = index">
                                        <ng-container *ngIf="i % 6 == 0">
                                            <div ngxSlickItem  class="slide">
                                                <div class="row parent_cardchip">
                                                    <div *ngIf="i + 0 < paymentTypeChipData.length">
                                                        <ng-template  [ngTemplateOutlet]="chipCardTemp" [ngTemplateOutletContext]="{item: paymentTypeChipData[i + 0]}"></ng-template>
                                                    </div>
                                                    <div *ngIf="i + 1 < paymentTypeChipData.length">
                                                        <ng-template  [ngTemplateOutlet]="chipCardTemp" [ngTemplateOutletContext]="{item: paymentTypeChipData[i + 1]}"></ng-template>
                                                    </div>
                                                    <div *ngIf="i + 2 < paymentTypeChipData.length">
                                                        <ng-template  [ngTemplateOutlet]="chipCardTemp" [ngTemplateOutletContext]="{item: paymentTypeChipData[i + 2]}"></ng-template>
                                                    </div>
                                                    <div *ngIf="i + 3 < paymentTypeChipData.length">
                                                        <ng-template  [ngTemplateOutlet]="chipCardTemp" [ngTemplateOutletContext]="{item: paymentTypeChipData[i + 3]}"></ng-template>
                                                    </div>
                                                    <div *ngIf="i + 4 < paymentTypeChipData.length">
                                                        <ng-template  [ngTemplateOutlet]="chipCardTemp" [ngTemplateOutletContext]="{item: paymentTypeChipData[i + 4]}"></ng-template>
                                                    </div>
                                                    <div *ngIf="i + 5 < paymentTypeChipData.length">
                                                        <ng-template  [ngTemplateOutlet]="chipCardTemp" [ngTemplateOutletContext]="{item: paymentTypeChipData[i + 5]}"></ng-template>
                                                    </div>

                                                </div>
                                            </div>

                                        </ng-container>
                                    </ng-container>
                                </ngx-slick>
                            </div>
                        </div>
                </ng-template>


                <div class="row">
                    <div class="row action_list">


                        <ng-container *ngIf="!isTabulator">

                            <span class="action_lbl"  *ngIf="isSelected">{{'ACTIONS'|translate}}:</span>
                            <div class="custom_action" *ngIf="isSelected">
                                <span class="icn_labels"  data-toggle="tooltip"  appHoverTooltip labelText="{{'GENERATEREPORT' | translate}}"  (click)="onBulkCampaignReport()"></span>
                            </div>
                        
                        </ng-container>

                        <ng-container *ngIf="isTabulator">
                            <ng-container *ngIf="selectedRows.length !== 0">
                                <span class="action_lbl">{{'ACTIONS'|translate}}:</span>
                                <div class="custom_action">
                                    <span class="icn_labels"  data-toggle="tooltip"  appHoverTooltip labelText="{{'GENERATEREPORT' | translate}}"  (click)="onBulkCampaignReport()"></span>
                                </div>
                            </ng-container>
                        </ng-container>


                        
                    </div>
                    <div class="tbl_colm_sticky campaign_sticky" [ngClass]="{'open_panel':isTotalPanelVisible==true,'isTabulator':isTabulator==true}" id="campaign_div">
                        <div class="modal_custom px-0 table-responsive transaction__table">
                             <div class="px-2" id="campaignsList" style="overflow-y: hidden; height: calc(100vh - 15rem);">
                                <div class="custom_campaignList-campaing-td" style="overflow-y: auto; height: 100%;" [ngClass]="{'show_pnl_tbl': isTotalPanelVisible===true }">
                                    <ng-container *ngIf="!isTabulator">

                                        <table class="table table-striped redesign_table" [svData]="gridFilterData" #sv="svDataTable" [svRowsOnPage]="25" svSortBy="campaign" svSortOrder="asc">
                                            <thead>
                                                <tr cdkDropList cdkDropListOrientation="horizontal" (cdkDropListDropped)="dropColumn($event)">
                                                    <th>
                                                        <input type="checkbox" appHoverTooltip labelText="{{'SELECT' | translate}}"  name="selectAll" id="select_all"(change)="selectRecord($event,'selectAll',null)" />
                                                        <label for="select_all" class="custom-checkbox"></label>
                                                    </th>
                                                    <th width="2%"></th>
                                                    <ng-container *ngFor="let groupHeader of colFields; let i=index" >
                                                        <ng-container *ngFor="let objHeader of groupHeader.items; let i=index" >
                                                            <ng-container *ngIf="objHeader.width">
                                                                <th cdkDrag *ngIf="checkVisibility(objHeader.colName)" [width]="objHeader.width"   [ngClass]="getTableTdClassName(objHeader)" >
                                                                    <sv-default-sorter  [by]="objHeader.sortName">{{objHeader.colName | translate}}</sv-default-sorter>
                                                                </th>
                                                            </ng-container>
                                                            <ng-container *ngIf="!objHeader.width">
                                                                <th cdkDrag *ngIf="checkVisibility(objHeader.colName)" [ngClass]="getTableTdClassName(objHeader)" >
                                                                    <sv-default-sorter  [by]="objHeader.sortName">{{objHeader.colName | translate}}</sv-default-sorter>
                                                                </th>
                                                            </ng-container>
                                                        </ng-container>
                                                   </ng-container>
                                                </tr>
                                            </thead>
    
                                        <tbody  *ngIf="sv.data?.length > 0">
                                            <tr>
    
                                                <td colspan="9" class="campaing-main-table">
                                                    <div [id]="'parent_div_' + item.campaignId" *ngFor="let item of sv.data; let i=index" tabindex={{i}} class="prnt_level table-row table-row-{{i}}">
                                                        <table>
                                                            <tr *ngIf="item.campaign">
                                                                <td><input #checkboxes  id="{{item.campaignId}} "type="checkbox" name="singlecheck" (change)="selectRecord($event,'singlecheck',item.campaignId)" [checked]="checkselectRecord(item.campaignId)"/>
                                                                    <label for="{{item.campaignId}}" class="custom-checkbox"></label>
                                                                    <span class="tooltip-custom">{{'SELECT'|translate}}</span></td>
                                                                <td width="2%"  (click)="OpenLevel1(item.campaignId)" class="arrow" [id]="'colarrow_' + item.campaignId"><span class="h_arrow arrow-disabled" *ngIf="item.children?.length == 0"></span><span *ngIf="item.children?.length > 0"  class="h_arrow"></span><span *ngIf="searchArrowIcon" class="h_arrow blank_space"></span></td>
    
                                                                <ng-container  *ngFor="let groupHeader of colFields;">
                                                                    <ng-container  *ngFor="let objHeader of groupHeader.items;">
                                                                        <ng-container  *ngIf="checkVisibility(objHeader.colName)">
                                                                          <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'campaignNumber'">{{item.campaignNumber}}</td>
                                                                            <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'campaign'" class="camp-name-td" [ngClass]="{'hebrew_lng': isHebrew_lng(item.campaign)}" (click)="OpenCampaignCard(item.campaignId)">{{item.campaign}}</td>
                                                                            <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'friendlyName'">{{item.friendlyName}}</td>
                                                                            <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'createdDate'">{{item.createdDate | donaryDateFormat: "long"}}</td>
    
                                                                            <ng-template [ngIf]="isTotalPanelVisible">
                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName=='payments'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(item.payments) }}</td>
                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName=='paymentsCount'" class="total_panel_tbl_td" >{{ item.paymentsCount }}</td>
                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName=='openPledges'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(item.openPledges) }}</td>
                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName=='pledgesCount'"  class="total_panel_tbl_td" >{{item.pledgesCount  }}</td>
                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName=='scheduled'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(item.scheduled) }}</td>
                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName=='schedulesCount'" class="total_panel_tbl_td" >{{ item.schedulesCount }}</td>
                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName=='raised'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(item.raised) }}</td>
                                                                               </ng-template>
                                                                        </ng-container>
                                                                    </ng-container>
                                                                </ng-container>
                                                            </tr>
                                                                <tr [id]="item.campaignId" style="display: none;">
    
                                                                    <td colspan="9" class="child-td" *ngIf="item.children?.length > 0">
                                                                        <div class="child_level" [id]="'level1_div_' + level1.campaignId" *ngFor="let level1 of item.children">
                                                                            <table>
                                                                                <tr>
                                                                                    <td><input #checkboxes  id="{{level1.campaignId}} "type="checkbox" name="singlecheck" (change)="selectRecord($event,'singlecheck',level1.campaignId)"
                                                                                        [checked]="checkselectRecord(level1.campaignId)"/>
                                                                                        <label for="{{level1.campaignId}}" class="custom-checkbox"></label>
                                                                                        <span class="tooltip-custom">{{'SELECT'|translate}}</span></td>
                                                                                    <td width="2%" (click)="OpenLevel2(level1.campaignId)"  class="arrow" [id]=" 'colarrow_' + level1.campaignId "><span class="h_arrow arrow-disabled" *ngIf="level1.children?.length == 0"></span><span  *ngIf="level1.children?.length > 0"  class="h_arrow"></span><span *ngIf="searchArrowIcon" class="h_arrow blank_space"></span></td>
    
                                                                                    <ng-container  *ngFor="let groupHeader of colFields;">
                                                                                        <ng-container  *ngFor="let objHeader of groupHeader.items;">
                                                                                            <ng-container  *ngIf="checkVisibility(objHeader.colName)">
                                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'campaignNumber'">{{level1.campaignNumber}}</td>
                                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'campaign'" > <span  class="parent-child-name" (click)="OpenCampaignCard(level1.campaignId)" [ngClass]="{'hebrew_lng': isHebrew_lng(level1.campaign)}" class="camp-name-td">{{level1.campaign}}&nbsp;/&nbsp;</span><span>{{item.campaign}}</span> </td>
                                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'friendlyName'">{{level1.friendlyName}}</td>
                                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'createdDate'">{{level1.createdDate | donaryDateFormat: "long"}}</td>
                                                                                                <ng-template [ngIf]="isTotalPanelVisible">
                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='payments'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level1.payments) }}</td>
                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='paymentsCount'" class="total_panel_tbl_td" >{{ level1.paymentsCount}}</td>
                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='openPledges'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level1.openPledges) }}</td>
                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='pledgesCount'"  class="total_panel_tbl_td" >{{level1.pledgesCount }}</td>
                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='scheduled'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level1.scheduled) }}</td>
                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='schedulesCount'" class="total_panel_tbl_td" >{{ level1.schedulesCount}}</td>
                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='raised'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level1.raised) }}</td>
                                                                                                   </ng-template>
                                                                                            </ng-container>
                                                                                        </ng-container>
                                                                                    </ng-container>
                                                                                </tr>
                                                                                <tr [id]="level1.campaignId" style="display: none;">
                                                                                    <td colspan="9" class="campaing-first-child" *ngIf="level1.children?.length > 0">
                                                                                        <div class="level2"  [id]="'level2_div_' + level2.campaignId" *ngFor="let level2 of level1.children">
                                                                                            <table>
                                                                                                <tr>
                                                                                                    <td><input #checkboxes  id="{{level2.campaignId}} "type="checkbox" name="singlecheck" (change)="selectRecord($event,'singlecheck',level2.campaignId)"
                                                                                                        [checked]="checkselectRecord(level2.campaignId)"/>
                                                                                                        <label for="{{level2.campaignId}}" class="custom-checkbox"></label>
                                                                                                        <span class="tooltip-custom">{{'SELECT'|translate}}</span></td>
                                                                                                    <td width="2%" (click)="OpenLevel3(level2.campaignId)"  class="arrow" [id]=" 'colarrow_' + level2.campaignId "><span class="h_arrow arrow-disabled" *ngIf="level2.children?.length == 0"></span><span  *ngIf="level2.children?.length > 0"  class="h_arrow"></span><span *ngIf="searchArrowIcon" class="h_arrow blank_space"></span></td>
    
                                                                                                    <ng-container  *ngFor="let groupHeader of colFields;">
    
                                                                                                        <ng-container  *ngFor="let objHeader of groupHeader.items;">
                                                                                                            <ng-container  *ngIf="checkVisibility(objHeader.colName)">
                                                                                                              <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'campaignNumber'">{{level2.campaignNumber}}</td>
                                                                                                              <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'campaign'" class="camp-name-td"> <span  class="parent-child-name" (click)="OpenCampaignCard(level2.campaignId)" [ngClass]="{'hebrew_lng': isHebrew_lng(level2.campaign)}" class="camp-name-td">{{level2.campaign}}&nbsp;/&nbsp;</span><span>{{level1.campaign}}&nbsp;/&nbsp;</span><span>{{item.campaign}}</span></td>
                                                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'friendlyName'">{{level2.friendlyName}}</td>
                                                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'createdDate'">{{level2.createdDate | donaryDateFormat: "long"}}</td>
                                                                                                                <ng-template [ngIf]="isTotalPanelVisible">
                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='payments'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level2.payments) }}</td>
                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='paymentsCount'" class="total_panel_tbl_td" >{{ level2.paymentsCount}}</td>
                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='openPledges'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level2.openPledges) }}</td>
                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='pledgesCount'"  class="total_panel_tbl_td" >{{level2.pledgesCount }}</td>
                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='scheduled'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level2.scheduled) }}</td>
                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='schedulesCount'" class="total_panel_tbl_td" >{{ level2.schedulesCount}}</td>
                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='raised'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level2.raised) }}</td>
                                                                                                                </ng-template>
                                                                                                            </ng-container>
                                                                                                        </ng-container>
                                                                                                    </ng-container>
    
    
                                                                                                </tr>
                                                                                                <tr [id]="level2.campaignId" style="display: none;">
                                                                                                    <td colspan="9"class="campaign-level-2" *ngIf="level2.children?.length > 0">
                                                                                                        <div class="level3" [id]="'level3_div_' + level3.campaignId" *ngFor="let level3 of level2.children">
                                                                                                            <table>
                                                                                                                <tr>
                                                                                                                    <td><input #checkboxes  id="{{level3.campaignId}} "type="checkbox" name="singlecheck" (change)="selectRecord($event,'singlecheck',level3.campaignId)"
                                                                                                                        [checked]="checkselectRecord(level3.campaignId)"/>
                                                                                                                        <label for="{{level3.campaignId}}" class="custom-checkbox"></label>
                                                                                                                        <span class="tooltip-custom">{{'SELECT'|translate}}</span></td>
                                                                                                                    <td width="2%" (click)="OpenLevel4(level3.campaignId)"  class="arrow" [id]=" 'colarrow_' + level3.campaignId "><span class="h_arrow arrow-disabled" *ngIf="level3.children?.length == 0"></span><span *ngIf="level3.children?.length > 0" class="h_arrow"></span><span *ngIf="searchArrowIcon" class="h_arrow blank_space"></span></td>
    
                                                                                                                    <ng-container  *ngFor="let groupHeader of colFields;">
                                                                                                                        <ng-container  *ngFor="let objHeader of groupHeader.items;">
                                                                                                                            <ng-container  *ngIf="checkVisibility(objHeader.colName)">
                                                                                                                              <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'campaignNumber'">{{level3.campaignNumber}}</td>
                                                                                                                              <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'campaign'" class="camp-name-td"><span  class="parent-child-name" (click)="OpenCampaignCard(level3.campaignId)" [ngClass]="{'hebrew_lng': isHebrew_lng(level3.campaign)}" class="camp-name-td">{{level3.campaign}}&nbsp;/&nbsp;</span><span>{{level2.campaign}}&nbsp;/&nbsp;</span><span>{{level1.campaign}}&nbsp;/&nbsp;</span><span>{{item.campaign}}</span></td>
                                                                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'friendlyName'">{{level3.friendlyName}}</td>
                                                                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'createdDate'">{{level3.createdDate | donaryDateFormat: "long"}}</td>
                                                                                                                                <ng-template [ngIf]="isTotalPanelVisible">
                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='payments'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level3.payments) }}</td>
                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='paymentsCount'" class="total_panel_tbl_td" >{{ level3.paymentsCount}}</td>
                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='openPledges'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level3.openPledges) }}</td>
                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='pledgesCount'"  class="total_panel_tbl_td" >{{level3.pledgesCount }}</td>
                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='scheduled'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level3.scheduled) }}</td>
                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='schedulesCount'" class="total_panel_tbl_td" >{{ level3.schedulesCount}}</td>
                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='raised'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level3.raised) }}</td>
                                                                                                                                </ng-template>
                                                                                                                            </ng-container>
                                                                                                                        </ng-container>
                                                                                                                    </ng-container>
                                                                                                                </tr>
                                                                                                                <tr  [id]="level3.campaignId" style="display: none;">
                                                                                                                    <td colspan="9" class="campaign-level-2"  *ngIf="level3.children?.length > 0">
                                                                                                                        <div class="level4" [id]="'level4_div_' + level3.campaignId" *ngFor="let level4 of level3.children">
                                                                                                                            <table>
                                                                                                                                <tr>
                                                                                                                                    <td><input #checkboxes  id="{{level4.campaignId}} "type="checkbox" name="singlecheck" (change)="selectRecord($event,'singlecheck',level4.campaignId)"
                                                                                                                                        [checked]="checkselectRecord(level4.campaignId)"/>
                                                                                                                                        <label for="{{level4.campaignId}}" class="custom-checkbox"></label>
                                                                                                                                        <span class="tooltip-custom">{{'SELECT'|translate}}</span></td>
                                                                                                                                        <td width="2%" (click)="OpenLevel5(level4.campaignId)"  class="arrow" [id]=" 'colarrow_' + level4.campaignId "><span class="h_arrow arrow-disabled" *ngIf="level4.children?.length == 0"></span><span *ngIf="level4.children?.length > 0" class="h_arrow"></span><span *ngIf="searchArrowIcon" class="h_arrow blank_space"></span></td>
    
                                                                                                                                    <ng-container  *ngFor="let groupHeader of colFields;">
                                                                                                                                        <ng-container  *ngFor="let objHeader of groupHeader.items;">
    
                                                                                                                                            <ng-container  *ngIf="checkVisibility(objHeader.colName)">
                                                                                                                                              <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'campaignNumber'">{{level4.campaignNumber}}</td>
                                                                                                                                              <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'campaign'" class="camp-name-td"><span  class="parent-child-name" (click)="OpenCampaignCard(level4.campaignId)" [ngClass]="{'hebrew_lng': isHebrew_lng(level4.campaign)}" class="camp-name-td">{{level4.campaign}}&nbsp;/&nbsp;</span><span>{{level3.campaign}}&nbsp;/&nbsp;</span><span>{{level2.campaign}}&nbsp;/&nbsp;</span><span>{{level1.campaign}}&nbsp;/&nbsp;</span><span>{{item.campaign}}</span></td>
                                                                                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'friendlyName'">{{level4.friendlyName}}</td>
                                                                                                                                                <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'createdDate'">{{level4.createdDate | donaryDateFormat: "long"}}</td>
                                                                                                                                                <ng-template [ngIf]="isTotalPanelVisible">
                                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='payments'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level4.payments) }}</td>
                                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='paymentsCount'" class="total_panel_tbl_td" >{{ level4.paymentsCount}}</td>
                                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='openPledges'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level4.openPledges) }}</td>
                                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='pledgesCount'"  class="total_panel_tbl_td" >{{level4.pledgesCount }}</td>
                                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='scheduled'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level4.scheduled) }}</td>
                                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='schedulesCount'" class="total_panel_tbl_td" >{{ level4.schedulesCount}}</td>
                                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName=='raised'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level4.raised) }}</td>
                                                                                                                                                </ng-template>
                                                                                                                                            </ng-container>
                                                                                                                                        </ng-container>
                                                                                                                                    </ng-container>
                                                                                                                                </tr>
                                                                                                                                <tr  [id]="level4.campaignId" style="display: none;">
                                                                                                                                    <td colspan="9" class="campaign-level-2"  *ngIf="level4.children?.length > 0">
                                                                                                                                        <div class="level5" [id]="'level5_div_' + level4.campaignId" *ngFor="let level5 of level4.children">
                                                                                                                                            <table>
                                                                                                                                                <tr>
                                                                                                                                                    <td><input #checkboxes  id="{{level5.campaignId}} "type="checkbox" name="singlecheck" (change)="selectRecord($event,'singlecheck',level5.campaignId)"
                                                                                                                                                        [checked]="checkselectRecord(level5.campaignId)"/>
                                                                                                                                                        <label for="{{level5.campaignId}}" class="custom-checkbox"></label>
                                                                                                                                                        <span class="tooltip-custom">{{'SELECT'|translate}}</span></td>
                                                                                                                                                        <td width="8%"></td>
                                                                                                                                                        <ng-container  *ngFor="let groupHeader of colFields;">
                                                                                                                                                            <ng-container  *ngFor="let objHeader of groupHeader.items;">
                        
                                                                                                                                                                <ng-container  *ngIf="checkVisibility(objHeader.colName)">
                                                                                                                                                                  <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'campaignNumber'">{{level5.campaignNumber}}</td>
                                                                                                                                                                  <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'campaign'" class="camp-name-td"><span  class="parent-child-name" (click)="OpenCampaignCard(level5.campaignId)" [ngClass]="{'hebrew_lng': isHebrew_lng(level5.campaign)}" class="camp-name-td">{{level5.campaign}}&nbsp;/&nbsp;</span><span>{{level4.campaign}}&nbsp;/&nbsp;</span><span>{{level3.campaign}}&nbsp;/&nbsp;</span><span>{{level2.campaign}}&nbsp;/&nbsp;</span><span>{{level1.campaign}}&nbsp;/&nbsp;</span><span>{{item.campaign}}</span></td>
                                                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'friendlyName'">{{level5.friendlyName}}</td>
                                                                                                                                                                    <td [width]="objHeader.width" *ngIf="objHeader.sortName === 'createdDate'">{{level5.createdDate | donaryDateFormat: "long"}}</td>
                                                                                                                                                                    <ng-template [ngIf]="isTotalPanelVisible">
                                                                                                                                                                        <td [width]="objHeader.width" *ngIf="objHeader.sortName=='payments'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level5.payments) }}</td>
                                                                                                                                                                        <td [width]="objHeader.width" *ngIf="objHeader.sortName=='paymentsCount'" class="total_panel_tbl_td" >{{ level5.paymentsCount}}</td>
                                                                                                                                                                        <td [width]="objHeader.width" *ngIf="objHeader.sortName=='openPledges'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level5.openPledges) }}</td>
                                                                                                                                                                        <td [width]="objHeader.width" *ngIf="objHeader.sortName=='pledgesCount'"  class="total_panel_tbl_td" >{{level5.pledgesCount }}</td>
                                                                                                                                                                        <td [width]="objHeader.width" *ngIf="objHeader.sortName=='scheduled'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level5.scheduled) }}</td>
                                                                                                                                                                        <td [width]="objHeader.width" *ngIf="objHeader.sortName=='schedulesCount'" class="total_panel_tbl_td" >{{ level5.schedulesCount}}</td>
                                                                                                                                                                        <td [width]="objHeader.width" *ngIf="objHeader.sortName=='raised'" class="total_panel_tbl_td" >{{ commonMethodService.formatAmount(level5.raised) }}</td>
                                                                                                                                                                    </ng-template>
                                                                                                                                                                </ng-container>
                                                                                                                                                            </ng-container>
                                                                                                                                                        </ng-container>
                                                                                                                                                </tr>
                                                                                                                                            </table>
                                                                                                                                        </div>
                                                                                                                                    </td>
                                                                                                                                </tr>
                                                                                                                            </table>
                                                                                                                            <div class="campaign-add" *ngIf="eventId=='7de5b4cf-c903-44a0-a834-f1b57d62264c'">
                                                                                                                                <span
                                                                                                                                    data-toggle="tooltip"
                                                                                                                                    appHoverTooltip labelText="{{'ADD' | translate}}"  (click)="SaveChargeTransaction(level4.campaignId)">
                                                                                                                                     <i _ngcontent-rvy-c6="" aria-hidden="true" class="fa fa-plus"></i>
                                                                                                                                </span>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </td>
                                                                                                                </tr>
                                                                                                            </table>
                                                                                                            <div class="campaign-add" *ngIf="eventId=='7de5b4cf-c903-44a0-a834-f1b57d62264c'">
                                                                                                                <span
                                                                                                                    data-toggle="tooltip"
                                                                                                                    appHoverTooltip labelText="{{'ADD' | translate}}" (click)="SaveChargeTransaction(level3.campaignId)">
                                                                                                                     <i _ngcontent-rvy-c6="" aria-hidden="true" class="fa fa-plus"></i>
                                                                                                                </span>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </td>
                                                                                                </tr>
                                                                                            </table>
                                                                                            <div class="campaign-add" *ngIf="eventId=='7de5b4cf-c903-44a0-a834-f1b57d62264c'">
                                                                                                <span
                                                                                                    data-toggle="tooltip"
                                                                                                    appHoverTooltip labelText="{{'ADD' | translate}}" (click)="SaveChargeTransaction(level2.campaignId)">
                                                                                                     <i _ngcontent-rvy-c6="" aria-hidden="true" class="fa fa-plus"></i>
                                                                                                </span>
                                                                                            </div>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            </table>
                                                                            <div class="campaign-add" *ngIf="eventId=='7de5b4cf-c903-44a0-a834-f1b57d62264c'">
                                                                                <span
                                                                                    data-toggle="tooltip"
                                                                                    appHoverTooltip labelText="{{'ADD' | translate}}" (click)="SaveChargeTransaction(level1.campaignId)">
                                                                                     <i _ngcontent-rvy-c6="" aria-hidden="true" class="fa fa-plus"></i>
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                        </table>
                                                        <div class="campaign-add" *ngIf="eventId=='7de5b4cf-c903-44a0-a834-f1b57d62264c'">
                                                            <span
                                                                data-toggle="tooltip"
                                                                appHoverTooltip labelText="{{'ADD' | translate}}" (click)="SaveChargeTransaction(item.campaignId)">
                                                                 <i _ngcontent-rvy-c6="" aria-hidden="true" class="fa fa-plus"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </td>
    
                                            </tr>
                                        </tbody>
                                            <tbody *ngIf="sv.data?.length == 0">
                                                <tr>
                                                    <td colspan="9" style="text-align: center;">{{'NODATAFOUND'|translate}}
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    
                                    </ng-container>

                                    <ng-container *ngIf="isTabulator">

                                        <app-tabulator-table 
                                            [updatedColumn]="lastUpdatedColumns"
                                            [columnNames]="columnNames" 
                                            [tableData]="gridFilterData" 
                                            [search]="searchVal" 
                                            [dataTree]="true"
                                            dataTreeElementColumn="campaign"
                                            [filterQuery]="filterQuery"
                                            (cellClick)="onCellClick($event)" 
                                            (rowSelectionChanged)="selectedRows = $event"
                                        >
                                        </app-tabulator-table>
                                    </ng-container>

                              
                                </div>
                            </div>
                        </div>
                    </div>


                    <ng-container *ngIf="!isTabulator && svTable">

                        <div class="new_tblfoot" [ngClass]="{'totalpnl_footer': isTotalPanelVisible===true }">
                            <div class="show_entry">  <span class="total_record">{{'SHOWING'|translate}} <span *ngIf="isFiltered"><strong>{{filterRecord}}</strong> {{'OF'|translate}} </span> <strong>{{totalRecord}}</strong> {{'RECORDS'|translate}}</span>
                            <div  class="custom_pagination">
                                <sv-bootstrap-paginator [svTable]="svTable"  [rowsOnPageSet]="[25, 50, 100]">
                                </sv-bootstrap-paginator>
                            </div>
                            </div>
                        </div>
                    </ng-container>

                </div>
                </div>
                <div *ngIf="isloading" class="overlay" [ngClass]="isCampaignUpload? 'campaignUpload' : ''">
                    <i class="fas fa-2x fa-sync-alt fa-spin"></i>
                </div>
            </div>
        </div>
    </section>
</div>


<ng-template #chipCardTemp let-item="item">
    <div class="col-3" *ngIf="item">
        <div [class]="item.paymentTypeChipCSSClass" [ngClass]="{'active': selectedItem === item}" (click)='selectedItem = item;' (click)="GetPaymentChipType(item)">
            <div class="info-box-content">
            <div class="row">
                <div class="col-12 top_value">
                    <span class="info-box-text" [title]="item.type">
                        {{ item.type }}
                    </span>
                    <span class="info-box-count">
                        ({{item.paymentCount}})
                    </span>
                </div>
                <div class="col-12 bottom_value">
                    <span class="info-box-number" >
                        {{commonMethodService.formatAmount(item.raised)}}
                    </span>
                </div>
            </div>
            </div>
        </div>
    </div>

</ng-template>

<!-- The Modal -->
<div class="modal fade import-doc" id="import-campaign-data">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">

        <!-- Modal Header -->
        <div class="modal-header ui-draggable-handle">
          <h4 class="modal-title">{{'Import Campaign'|translate}}</h4>
          <button type="button" class="close" data-dismiss="modal" (click)="reseteFile()">&times;</button>
        </div>

        <!-- Modal body -->
        <div class="modal-body">
         <div class="import-doc-body">
            <div id="other" class="file-drop-area {{changeText}}"
                            draggable="true"
                (dragstart)="changeText='is-active'"
                (drag)="changeText='is-active'"
                (dragover)="changeText='is-active'"
                (drop)="changeText='is-active'"
                (dragend)="changeText=''"
            >
            <div id="campaignNotReadyToUpload" class="file-not-ready">
                <span class="file-msg text-center"><i class="cloud-upload"></i>{{'DRAGFILEUPLOAD'|translate}}</span>
                <label class="file-devider">{{'OR'|translate}}</label>
                <input class="file-input" type="file" name="campaign_doc_file" id="campaign_doc_file" (change)="incomingfile($event)" placeholder="{{'UPLOADFILE' | translate}}" accept=".xlsx">
                <span class="fake-btn">{{'CHOOSEFILE'|translate}}</span>
            </div>
            <div id="campaignReadyToUpload" class="file-ready" style="display: none;">
                <span class="file-msg text-center"><i class="cloud-upload"></i> {{'FILEREADY'|translate}}</span>
                <div class="label-download">
                    <button class="download-excel-tem">{{ fileName }}</button>
                </div>
            </div>
            </div>
              <div class="label-download"><a href="assets/importTemplate/CampaignTemplate.xlsx" class="download-excel-tem"><i  class="xls-file"></i>
                {{'DOWNLOADEXCEL'|translate}}</a></div>
         </div>
        </div>

        <!-- Modal footer -->
        <div class="modal-footer">
          <button type="button" data-dismiss="modal" class="btn btn-default"(click)="reseteFile()">{{'CANCEL'|translate}}</button>
          <button type="button" class="btn btn-primary" (click)="uploadExcelTemplate()">{{'UPLOAD'|translate}}</button>
        </div>
      </div>
    </div>
  </div>
